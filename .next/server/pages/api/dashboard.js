"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/dashboard";
exports.ids = ["pages/api/dashboard"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdashboard&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fdashboard.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdashboard&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fdashboard.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_dashboard_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/dashboard.ts */ \"(api)/./pages/api/dashboard.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_dashboard_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_dashboard_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/dashboard\",\n        pathname: \"/api/dashboard\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_dashboard_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmRhc2hib2FyZCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGZGFzaGJvYXJkLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ3FEO0FBQ3JEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxvREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsb0RBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3BzaW50ZWwtYWktZGFzaGJvYXJkLz84ZTdmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvZGFzaGJvYXJkLnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZGFzaGJvYXJkXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZGFzaGJvYXJkXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdashboard&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fdashboard.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/dashboard.ts":
/*!********************************!*\
  !*** ./pages/api/dashboard.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _src_lib_fetchFred__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../src/lib/fetchFred */ \"(api)/./src/lib/fetchFred.ts\");\n/* harmony import */ var _src_lib_fetchEia__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../src/lib/fetchEia */ \"(api)/./src/lib/fetchEia.ts\");\n/* harmony import */ var _src_lib_fetchWeather__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../src/lib/fetchWeather */ \"(api)/./src/lib/fetchWeather.ts\");\n/* harmony import */ var _src_lib_fetchInsight__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../src/lib/fetchInsight */ \"(api)/./src/lib/fetchInsight.ts\");\n/**\n * Dashboard API Endpoint - Data Flow and Module Responsibilities\n * \n * PURPOSE: Serves aggregated dashboard data with caching and insights for the client application\n * \n * MODULE RESPONSIBILITIES:\n * - Data Fetch Module: Retrieves raw data from external APIs, databases, or services\n *   • fetchFred.ts: FRED API for Industrial Production Index with MoM trends\n *   • fetchEia.ts: EIA API for Texas electricity pricing with trend analysis\n *   • fetchWeather.ts: OpenWeatherMap API for El Paso weather and alerts\n * - Cache Module: Implements caching strategy to reduce API calls and improve performance\n *   • In-memory cache with configurable TTL (FRED: 1hr, EIA: 10min, Weather: 15min, Insights: 30min)\n *   • SHA-1 hash-based cache invalidation for intelligent updates\n * - Insight Module: Processes raw data to generate analytics, trends, and business insights\n *   • fetchInsight.ts: Claude AI analysis for operational recommendations\n *   • Smart caching prevents redundant AI calls for unchanged data\n * \n * DATA FLOW:\n * 1. Client Request → API endpoint (/pages/api/dashboard.ts)\n * 2. Check Cache Module → Return cached data if valid and available\n * 3. If cache miss → Data Fetch Module retrieves fresh data from sources\n *    • Concurrent API calls to FRED, EIA, and OpenWeatherMap\n *    • Promise.allSettled() ensures partial failures don't break the system\n * 4. Raw data → Insight Module for processing and analysis\n *    • Generate SHA-1 hash from combined data for change detection\n *    • Call Claude AI only if data hash changed or manual refresh requested\n * 5. Processed data → Cache Module for storage with TTL\n * 6. Final response → Client with structured dashboard data\n * \n * RESPONSE FORMAT:\n * {\n *   \"data\": {\n *     \"production\": { \"index\": 102.5, \"trend\": \"↑ 2.1% MoM\" },\n *     \"energy\": { \"centsPerKwh\": 12.8, \"trend\": \"up\" },\n *     \"weather\": { \"temp\": 95, \"alert\": \"none\" },\n *     \"insight\": {\n *       \"summary\": \"Production strong, energy costs rising\",\n *       \"recommendation\": \"Consider energy optimization strategies\"\n *     }\n *   },\n *   \"lastFetched\": \"2024-01-15T10:30:00Z\",\n *   \"lastInsightRun\": \"2024-01-15T09:45:00Z\"\n * }\n * \n * ERROR HANDLING:\n * - Individual API failures are handled gracefully with fallback data\n * - Claude AI failures fall back to cached insights or contextual defaults\n * - Always returns HTTP 200 with complete response structure\n * - Detailed error logging for monitoring and debugging\n * - Rate limit handling with appropriate retry strategies\n * \n * PERFORMANCE:\n * - Data caching: Variable TTL (FRED: 1hr, EIA: 10min, Weather: 15min)\n * - Insight caching: 30 minutes TTL for Claude AI responses\n * - Concurrent API calls reduce total response time\n * - SHA-1 hash comparison prevents unnecessary Claude API calls\n * - Manual refresh option via ?refresh=true query parameter\n * - Rate limits: Respects external API limits with caching and fallbacks\n */ \n\n\n\n\n// Simple in-memory cache for dashboard data\nclass DashboardCache {\n    setData(key, data, ttl) {\n        const now = new Date().toISOString();\n        this.dataCache.set(key, {\n            data,\n            lastFetched: now,\n            expires: Date.now() + ttl\n        });\n    }\n    getData(key) {\n        const item = this.dataCache.get(key);\n        if (!item || Date.now() > item.expires) {\n            this.dataCache.delete(key);\n            return null;\n        }\n        return item;\n    }\n    setInsight(dataHash, insight) {\n        const now = new Date().toISOString();\n        this.insightCache.set(dataHash, {\n            insight,\n            dataHash,\n            lastInsightRun: now,\n            expires: Date.now() + this.INSIGHT_TTL\n        });\n    }\n    getInsight(dataHash) {\n        const item = this.insightCache.get(dataHash);\n        if (!item || Date.now() > item.expires) {\n            this.insightCache.delete(dataHash);\n            return null;\n        }\n        return item;\n    }\n    getLatestInsight() {\n        let latest = null;\n        let latestTime = 0;\n        for (const entry of this.insightCache.values()){\n            const entryTime = new Date(entry.lastInsightRun).getTime();\n            if (entryTime > latestTime) {\n                latest = entry;\n                latestTime = entryTime;\n            }\n        }\n        return latest;\n    }\n    getTTL(source) {\n        switch(source){\n            case \"fred\":\n                return this.FRED_TTL;\n            case \"eia\":\n                return this.EIA_TTL;\n            case \"weather\":\n                return this.WEATHER_TTL;\n            default:\n                return this.EIA_TTL;\n        }\n    }\n    constructor(){\n        this.dataCache = new Map();\n        this.insightCache = new Map();\n        this.FRED_TTL = 60 * 60 * 1000 // 1 hour\n        ;\n        this.EIA_TTL = 10 * 60 * 1000 // 10 minutes\n        ;\n        this.WEATHER_TTL = 15 * 60 * 1000 // 15 minutes\n        ;\n        this.INSIGHT_TTL = 30 * 60 * 1000 // 30 minutes\n        ;\n    }\n}\nconst cache = new DashboardCache();\n/**\n * Generates SHA-1 hash from combined data for cache invalidation\n */ function generateDataHash(production, energy, weather) {\n    const combinedData = {\n        production: {\n            index: Math.round(production.index * 10) / 10,\n            trend: production.trend\n        },\n        energy: {\n            centsPerKwh: Math.round(energy.centsPerKwh * 100) / 100,\n            trend: energy.trend\n        },\n        weather: {\n            temp: Math.round(weather.temp / 5) * 5,\n            alert: weather.alert\n        }\n    };\n    const dataString = JSON.stringify(combinedData, Object.keys(combinedData).sort());\n    return crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash(\"sha1\").update(dataString).digest(\"hex\");\n}\n/**\n * Fetches data from a specific source with caching and error handling\n */ async function fetchWithCache(source, fetchFn, fallback) {\n    // Check cache first\n    const cached = cache.getData(source);\n    if (cached) {\n        return {\n            data: cached.data,\n            lastFetched: cached.lastFetched\n        };\n    }\n    // Fetch fresh data\n    try {\n        const data = await fetchFn();\n        const ttl = cache.getTTL(source);\n        cache.setData(source, data, ttl);\n        const cachedEntry = cache.getData(source);\n        return {\n            data,\n            lastFetched: cachedEntry?.lastFetched || new Date().toISOString()\n        };\n    } catch (error) {\n        console.error(`Error fetching ${source} data:`, error);\n        // Return fallback data\n        return {\n            data: fallback,\n            lastFetched: new Date().toISOString()\n        };\n    }\n}\n/**\n * Fetches data from all sources with individual caching and error handling\n */ async function fetchAllData() {\n    // Fetch all data sources concurrently with individual caching\n    const [productionResult, energyResult, weatherResult] = await Promise.allSettled([\n        fetchWithCache(\"fred\", _src_lib_fetchFred__WEBPACK_IMPORTED_MODULE_1__.getProductionIndex, {\n            index: 102.4,\n            trend: \"→ Data unavailable\"\n        }),\n        fetchWithCache(\"eia\", _src_lib_fetchEia__WEBPACK_IMPORTED_MODULE_2__.getEnergyPrice, {\n            centsPerKwh: 12.5,\n            trend: \"stable\"\n        }),\n        fetchWithCache(\"weather\", _src_lib_fetchWeather__WEBPACK_IMPORTED_MODULE_3__.getLocalWeather, {\n            temp: 75,\n            alert: \"Weather data unavailable\"\n        })\n    ]);\n    // Extract data with fallbacks\n    const production = productionResult.status === \"fulfilled\" ? productionResult.value.data : {\n        index: 102.4,\n        trend: \"→ Data unavailable\"\n    };\n    const energy = energyResult.status === \"fulfilled\" ? energyResult.value.data : {\n        centsPerKwh: 12.5,\n        trend: \"stable\"\n    };\n    const weather = weatherResult.status === \"fulfilled\" ? weatherResult.value.data : {\n        temp: 75,\n        alert: \"Weather data unavailable\"\n    };\n    // Get the most recent lastFetched timestamp\n    const timestamps = [\n        productionResult.status === \"fulfilled\" ? productionResult.value.lastFetched : null,\n        energyResult.status === \"fulfilled\" ? energyResult.value.lastFetched : null,\n        weatherResult.status === \"fulfilled\" ? weatherResult.value.lastFetched : null\n    ].filter(Boolean);\n    const lastFetched = timestamps.length > 0 ? new Date(Math.max(...timestamps.map((t)=>new Date(t).getTime()))).toISOString() : new Date().toISOString();\n    // Log any failures for debugging\n    if (productionResult.status === \"rejected\") {\n        console.error(\"Production data fetch failed:\", productionResult.reason);\n    }\n    if (energyResult.status === \"rejected\") {\n        console.error(\"Energy data fetch failed:\", energyResult.reason);\n    }\n    if (weatherResult.status === \"rejected\") {\n        console.error(\"Weather data fetch failed:\", weatherResult.reason);\n    }\n    return {\n        production,\n        energy,\n        weather,\n        lastFetched\n    };\n}\n/**\n * Main dashboard API handler\n */ async function handler(req, res) {\n    try {\n        const isManualRefresh = req.query.refresh === \"true\";\n        // Fetch all data sources\n        const { production, energy, weather, lastFetched } = await fetchAllData();\n        // Generate hash for change detection\n        const currentDataHash = generateDataHash(production, energy, weather);\n        // Check if we need new insights (data changed or manual refresh)\n        const cachedInsight = cache.getInsight(currentDataHash);\n        const needsInsightUpdate = isManualRefresh || !cachedInsight;\n        let insight;\n        let lastInsightRun = null;\n        if (needsInsightUpdate) {\n            console.log(\"Generating new insights with Claude AI...\");\n            try {\n                insight = await (0,_src_lib_fetchInsight__WEBPACK_IMPORTED_MODULE_4__.analyzeInsight)({\n                    production,\n                    energy,\n                    weather\n                });\n                cache.setInsight(currentDataHash, insight);\n                const newCachedInsight = cache.getInsight(currentDataHash);\n                lastInsightRun = newCachedInsight?.lastInsightRun || new Date().toISOString();\n            } catch (error) {\n                console.error(\"Claude insight generation failed:\", error);\n                // Try to use any available cached insight\n                const latestInsight = cache.getLatestInsight();\n                if (latestInsight) {\n                    insight = latestInsight.insight;\n                    lastInsightRun = latestInsight.lastInsightRun;\n                } else {\n                    // Generate contextual fallback based on data patterns\n                    insight = generateFallbackInsight(production, energy, weather);\n                    lastInsightRun = null;\n                }\n            }\n        } else {\n            // Use cached insight\n            insight = cachedInsight.insight;\n            lastInsightRun = cachedInsight.lastInsightRun;\n        }\n        // Construct response data\n        const dashboardData = {\n            production,\n            energy,\n            weather,\n            insight\n        };\n        const response = {\n            data: dashboardData,\n            lastFetched,\n            lastInsightRun\n        };\n        res.status(200).json(response);\n    } catch (error) {\n        console.error(\"Dashboard API error:\", error);\n        // Return fallback response with proper metadata\n        const fallbackResponse = {\n            data: {\n                production: {\n                    index: 102.4,\n                    trend: \"→ Data unavailable\"\n                },\n                energy: {\n                    centsPerKwh: 12.5,\n                    trend: \"stable\"\n                },\n                weather: {\n                    temp: 75,\n                    alert: \"Data unavailable\"\n                },\n                insight: {\n                    summary: \"System temporarily unavailable\",\n                    recommendation: \"Please try refreshing in a few minutes\"\n                }\n            },\n            lastFetched: new Date().toISOString(),\n            lastInsightRun: null\n        };\n        res.status(200).json(fallbackResponse);\n    }\n}\n/**\n * Generates contextual fallback insights based on data patterns\n */ function generateFallbackInsight(production, energy, weather) {\n    let summary = \"Data analysis temporarily unavailable\";\n    let recommendation = \"Monitor key metrics and adjust operations as needed\";\n    // Provide basic insights based on data patterns\n    if (weather.temp >= 100) {\n        summary = \"Extreme heat conditions detected\";\n        recommendation = \"Consider shifting operations to cooler hours to reduce energy costs\";\n    } else if (energy.trend === \"up\") {\n        summary = \"Energy costs trending upward\";\n        recommendation = \"Optimize energy usage and consider off-peak scheduling\";\n    } else if (weather.alert !== \"none\" && weather.alert !== \"Weather data unavailable\") {\n        summary = \"Weather alert active\";\n        recommendation = \"Monitor weather conditions and prepare contingency plans\";\n    } else if (production.trend.includes(\"↓\")) {\n        summary = \"Production index declining\";\n        recommendation = \"Review production processes and identify improvement opportunities\";\n    } else if (production.trend.includes(\"↑\")) {\n        summary = \"Production performing well\";\n        recommendation = \"Maintain current efficiency while monitoring energy costs\";\n    }\n    return {\n        summary,\n        recommendation\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SixPQUFPQyxXQUFXO1lBQ25DYSxnQkFBZ0I7UUFDbEI7UUFFQStELElBQUlaLE1BQU0sQ0FBQyxLQUFLeUIsSUFBSSxDQUFDQztJQUN2QjtBQUNGO0FBRUE7O0NBRUMsR0FDRCxTQUFTSix3QkFDUHZELFVBQTBCLEVBQzFCQyxNQUFrQixFQUNsQkMsT0FBb0I7SUFFcEIsSUFBSTBELFVBQVU7SUFDZCxJQUFJQyxpQkFBaUI7SUFFckIsZ0RBQWdEO0lBQ2hELElBQUkzRCxRQUFRTyxJQUFJLElBQUksS0FBSztRQUN2Qm1ELFVBQVU7UUFDVkMsaUJBQWlCO0lBQ25CLE9BQU8sSUFBSTVELE9BQU9NLEtBQUssS0FBSyxNQUFNO1FBQ2hDcUQsVUFBVTtRQUNWQyxpQkFBaUI7SUFDbkIsT0FBTyxJQUFJM0QsUUFBUVEsS0FBSyxLQUFLLFVBQVVSLFFBQVFRLEtBQUssS0FBSyw0QkFBNEI7UUFDbkZrRCxVQUFVO1FBQ1ZDLGlCQUFpQjtJQUNuQixPQUFPLElBQUk3RCxXQUFXTyxLQUFLLENBQUN1RCxRQUFRLENBQUMsTUFBTTtRQUN6Q0YsVUFBVTtRQUNWQyxpQkFBaUI7SUFDbkIsT0FBTyxJQUFJN0QsV0FBV08sS0FBSyxDQUFDdUQsUUFBUSxDQUFDLE1BQU07UUFDekNGLFVBQVU7UUFDVkMsaUJBQWlCO0lBQ25CO0lBRUEsT0FBTztRQUNMRDtRQUNBQztJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vcHNpbnRlbC1haS1kYXNoYm9hcmQvLi9wYWdlcy9hcGkvZGFzaGJvYXJkLnRzP2Q2YmEiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBEYXNoYm9hcmQgQVBJIEVuZHBvaW50IC0gRGF0YSBGbG93IGFuZCBNb2R1bGUgUmVzcG9uc2liaWxpdGllc1xuICogXG4gKiBQVVJQT1NFOiBTZXJ2ZXMgYWdncmVnYXRlZCBkYXNoYm9hcmQgZGF0YSB3aXRoIGNhY2hpbmcgYW5kIGluc2lnaHRzIGZvciB0aGUgY2xpZW50IGFwcGxpY2F0aW9uXG4gKiBcbiAqIE1PRFVMRSBSRVNQT05TSUJJTElUSUVTOlxuICogLSBEYXRhIEZldGNoIE1vZHVsZTogUmV0cmlldmVzIHJhdyBkYXRhIGZyb20gZXh0ZXJuYWwgQVBJcywgZGF0YWJhc2VzLCBvciBzZXJ2aWNlc1xuICogICDigKIgZmV0Y2hGcmVkLnRzOiBGUkVEIEFQSSBmb3IgSW5kdXN0cmlhbCBQcm9kdWN0aW9uIEluZGV4IHdpdGggTW9NIHRyZW5kc1xuICogICDigKIgZmV0Y2hFaWEudHM6IEVJQSBBUEkgZm9yIFRleGFzIGVsZWN0cmljaXR5IHByaWNpbmcgd2l0aCB0cmVuZCBhbmFseXNpc1xuICogICDigKIgZmV0Y2hXZWF0aGVyLnRzOiBPcGVuV2VhdGhlck1hcCBBUEkgZm9yIEVsIFBhc28gd2VhdGhlciBhbmQgYWxlcnRzXG4gKiAtIENhY2hlIE1vZHVsZTogSW1wbGVtZW50cyBjYWNoaW5nIHN0cmF0ZWd5IHRvIHJlZHVjZSBBUEkgY2FsbHMgYW5kIGltcHJvdmUgcGVyZm9ybWFuY2VcbiAqICAg4oCiIEluLW1lbW9yeSBjYWNoZSB3aXRoIGNvbmZpZ3VyYWJsZSBUVEwgKEZSRUQ6IDFociwgRUlBOiAxMG1pbiwgV2VhdGhlcjogMTVtaW4sIEluc2lnaHRzOiAzMG1pbilcbiAqICAg4oCiIFNIQS0xIGhhc2gtYmFzZWQgY2FjaGUgaW52YWxpZGF0aW9uIGZvciBpbnRlbGxpZ2VudCB1cGRhdGVzXG4gKiAtIEluc2lnaHQgTW9kdWxlOiBQcm9jZXNzZXMgcmF3IGRhdGEgdG8gZ2VuZXJhdGUgYW5hbHl0aWNzLCB0cmVuZHMsIGFuZCBidXNpbmVzcyBpbnNpZ2h0c1xuICogICDigKIgZmV0Y2hJbnNpZ2h0LnRzOiBDbGF1ZGUgQUkgYW5hbHlzaXMgZm9yIG9wZXJhdGlvbmFsIHJlY29tbWVuZGF0aW9uc1xuICogICDigKIgU21hcnQgY2FjaGluZyBwcmV2ZW50cyByZWR1bmRhbnQgQUkgY2FsbHMgZm9yIHVuY2hhbmdlZCBkYXRhXG4gKiBcbiAqIERBVEEgRkxPVzpcbiAqIDEuIENsaWVudCBSZXF1ZXN0IOKGkiBBUEkgZW5kcG9pbnQgKC9wYWdlcy9hcGkvZGFzaGJvYXJkLnRzKVxuICogMi4gQ2hlY2sgQ2FjaGUgTW9kdWxlIOKGkiBSZXR1cm4gY2FjaGVkIGRhdGEgaWYgdmFsaWQgYW5kIGF2YWlsYWJsZVxuICogMy4gSWYgY2FjaGUgbWlzcyDihpIgRGF0YSBGZXRjaCBNb2R1bGUgcmV0cmlldmVzIGZyZXNoIGRhdGEgZnJvbSBzb3VyY2VzXG4gKiAgICDigKIgQ29uY3VycmVudCBBUEkgY2FsbHMgdG8gRlJFRCwgRUlBLCBhbmQgT3BlbldlYXRoZXJNYXBcbiAqICAgIOKAoiBQcm9taXNlLmFsbFNldHRsZWQoKSBlbnN1cmVzIHBhcnRpYWwgZmFpbHVyZXMgZG9uJ3QgYnJlYWsgdGhlIHN5c3RlbVxuICogNC4gUmF3IGRhdGEg4oaSIEluc2lnaHQgTW9kdWxlIGZvciBwcm9jZXNzaW5nIGFuZCBhbmFseXNpc1xuICogICAg4oCiIEdlbmVyYXRlIFNIQS0xIGhhc2ggZnJvbSBjb21iaW5lZCBkYXRhIGZvciBjaGFuZ2UgZGV0ZWN0aW9uXG4gKiAgICDigKIgQ2FsbCBDbGF1ZGUgQUkgb25seSBpZiBkYXRhIGhhc2ggY2hhbmdlZCBvciBtYW51YWwgcmVmcmVzaCByZXF1ZXN0ZWRcbiAqIDUuIFByb2Nlc3NlZCBkYXRhIOKGkiBDYWNoZSBNb2R1bGUgZm9yIHN0b3JhZ2Ugd2l0aCBUVExcbiAqIDYuIEZpbmFsIHJlc3BvbnNlIOKGkiBDbGllbnQgd2l0aCBzdHJ1Y3R1cmVkIGRhc2hib2FyZCBkYXRhXG4gKiBcbiAqIFJFU1BPTlNFIEZPUk1BVDpcbiAqIHtcbiAqICAgXCJkYXRhXCI6IHtcbiAqICAgICBcInByb2R1Y3Rpb25cIjogeyBcImluZGV4XCI6IDEwMi41LCBcInRyZW5kXCI6IFwi4oaRIDIuMSUgTW9NXCIgfSxcbiAqICAgICBcImVuZXJneVwiOiB7IFwiY2VudHNQZXJLd2hcIjogMTIuOCwgXCJ0cmVuZFwiOiBcInVwXCIgfSxcbiAqICAgICBcIndlYXRoZXJcIjogeyBcInRlbXBcIjogOTUsIFwiYWxlcnRcIjogXCJub25lXCIgfSxcbiAqICAgICBcImluc2lnaHRcIjoge1xuICogICAgICAgXCJzdW1tYXJ5XCI6IFwiUHJvZHVjdGlvbiBzdHJvbmcsIGVuZXJneSBjb3N0cyByaXNpbmdcIixcbiAqICAgICAgIFwicmVjb21tZW5kYXRpb25cIjogXCJDb25zaWRlciBlbmVyZ3kgb3B0aW1pemF0aW9uIHN0cmF0ZWdpZXNcIlxuICogICAgIH1cbiAqICAgfSxcbiAqICAgXCJsYXN0RmV0Y2hlZFwiOiBcIjIwMjQtMDEtMTVUMTA6MzA6MDBaXCIsXG4gKiAgIFwibGFzdEluc2lnaHRSdW5cIjogXCIyMDI0LTAxLTE1VDA5OjQ1OjAwWlwiXG4gKiB9XG4gKiBcbiAqIEVSUk9SIEhBTkRMSU5HOlxuICogLSBJbmRpdmlkdWFsIEFQSSBmYWlsdXJlcyBhcmUgaGFuZGxlZCBncmFjZWZ1bGx5IHdpdGggZmFsbGJhY2sgZGF0YVxuICogLSBDbGF1ZGUgQUkgZmFpbHVyZXMgZmFsbCBiYWNrIHRvIGNhY2hlZCBpbnNpZ2h0cyBvciBjb250ZXh0dWFsIGRlZmF1bHRzXG4gKiAtIEFsd2F5cyByZXR1cm5zIEhUVFAgMjAwIHdpdGggY29tcGxldGUgcmVzcG9uc2Ugc3RydWN0dXJlXG4gKiAtIERldGFpbGVkIGVycm9yIGxvZ2dpbmcgZm9yIG1vbml0b3JpbmcgYW5kIGRlYnVnZ2luZ1xuICogLSBSYXRlIGxpbWl0IGhhbmRsaW5nIHdpdGggYXBwcm9wcmlhdGUgcmV0cnkgc3RyYXRlZ2llc1xuICogXG4gKiBQRVJGT1JNQU5DRTpcbiAqIC0gRGF0YSBjYWNoaW5nOiBWYXJpYWJsZSBUVEwgKEZSRUQ6IDFociwgRUlBOiAxMG1pbiwgV2VhdGhlcjogMTVtaW4pXG4gKiAtIEluc2lnaHQgY2FjaGluZzogMzAgbWludXRlcyBUVEwgZm9yIENsYXVkZSBBSSByZXNwb25zZXNcbiAqIC0gQ29uY3VycmVudCBBUEkgY2FsbHMgcmVkdWNlIHRvdGFsIHJlc3BvbnNlIHRpbWVcbiAqIC0gU0hBLTEgaGFzaCBjb21wYXJpc29uIHByZXZlbnRzIHVubmVjZXNzYXJ5IENsYXVkZSBBUEkgY2FsbHNcbiAqIC0gTWFudWFsIHJlZnJlc2ggb3B0aW9uIHZpYSA/cmVmcmVzaD10cnVlIHF1ZXJ5IHBhcmFtZXRlclxuICogLSBSYXRlIGxpbWl0czogUmVzcGVjdHMgZXh0ZXJuYWwgQVBJIGxpbWl0cyB3aXRoIGNhY2hpbmcgYW5kIGZhbGxiYWNrc1xuICovXG5cbmltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nO1xuaW1wb3J0IHsgZ2V0UHJvZHVjdGlvbkluZGV4IH0gZnJvbSAnLi4vLi4vc3JjL2xpYi9mZXRjaEZyZWQnO1xuaW1wb3J0IHsgZ2V0RW5lcmd5UHJpY2UgfSBmcm9tICcuLi8uLi9zcmMvbGliL2ZldGNoRWlhJztcbmltcG9ydCB7IGdldExvY2FsV2VhdGhlciB9IGZyb20gJy4uLy4uL3NyYy9saWIvZmV0Y2hXZWF0aGVyJztcbmltcG9ydCB7IGFuYWx5emVJbnNpZ2h0IH0gZnJvbSAnLi4vLi4vc3JjL2xpYi9mZXRjaEluc2lnaHQnO1xuXG5pbnRlcmZhY2UgUHJvZHVjdGlvbkRhdGEge1xuICBpbmRleDogbnVtYmVyO1xuICB0cmVuZDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgRW5lcmd5RGF0YSB7XG4gIGNlbnRzUGVyS3doOiBudW1iZXI7XG4gIHRyZW5kOiAndXAnIHwgJ2Rvd24nIHwgJ3N0YWJsZSc7XG59XG5cbmludGVyZmFjZSBXZWF0aGVyRGF0YSB7XG4gIHRlbXA6IG51bWJlcjtcbiAgYWxlcnQ6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIEluc2lnaHREYXRhIHtcbiAgc3VtbWFyeTogc3RyaW5nO1xuICByZWNvbW1lbmRhdGlvbjogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgRGFzaGJvYXJkRGF0YSB7XG4gIHByb2R1Y3Rpb246IFByb2R1Y3Rpb25EYXRhO1xuICBlbmVyZ3k6IEVuZXJneURhdGE7XG4gIHdlYXRoZXI6IFdlYXRoZXJEYXRhO1xuICBpbnNpZ2h0OiBJbnNpZ2h0RGF0YTtcbn1cblxuaW50ZXJmYWNlIERhc2hib2FyZFJlc3BvbnNlIHtcbiAgZGF0YTogRGFzaGJvYXJkRGF0YTtcbiAgbGFzdEZldGNoZWQ6IHN0cmluZztcbiAgbGFzdEluc2lnaHRSdW46IHN0cmluZyB8IG51bGw7XG59XG5cbmludGVyZmFjZSBEYXRhQ2FjaGVFbnRyeSB7XG4gIGRhdGE6IFByb2R1Y3Rpb25EYXRhIHwgRW5lcmd5RGF0YSB8IFdlYXRoZXJEYXRhO1xuICBsYXN0RmV0Y2hlZDogc3RyaW5nO1xuICBleHBpcmVzOiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBJbnNpZ2h0Q2FjaGVFbnRyeSB7XG4gIGluc2lnaHQ6IEluc2lnaHREYXRhO1xuICBkYXRhSGFzaDogc3RyaW5nO1xuICBsYXN0SW5zaWdodFJ1bjogc3RyaW5nO1xuICBleHBpcmVzOiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBEYXNoYm9hcmRDYWNoZUVudHJ5IHtcbiAgZGF0YTogRGFzaGJvYXJkRGF0YTtcbiAgZGF0YUhhc2g6IHN0cmluZztcbiAgbGFzdEZldGNoZWQ6IHN0cmluZztcbiAgbGFzdEluc2lnaHRSdW46IHN0cmluZyB8IG51bGw7XG4gIGV4cGlyZXM6IG51bWJlcjtcbn1cblxuLy8gU2ltcGxlIGluLW1lbW9yeSBjYWNoZSBmb3IgZGFzaGJvYXJkIGRhdGFcbmNsYXNzIERhc2hib2FyZENhY2hlIHtcbiAgcHJpdmF0ZSBkYXRhQ2FjaGUgPSBuZXcgTWFwPHN0cmluZywgRGF0YUNhY2hlRW50cnk+KCk7XG4gIHByaXZhdGUgaW5zaWdodENhY2hlID0gbmV3IE1hcDxzdHJpbmcsIEluc2lnaHRDYWNoZUVudHJ5PigpO1xuICBwcml2YXRlIHJlYWRvbmx5IEZSRURfVFRMID0gNjAgKiA2MCAqIDEwMDA7IC8vIDEgaG91clxuICBwcml2YXRlIHJlYWRvbmx5IEVJQV9UVEwgPSAxMCAqIDYwICogMTAwMDsgLy8gMTAgbWludXRlc1xuICBwcml2YXRlIHJlYWRvbmx5IFdFQVRIRVJfVFRMID0gMTUgKiA2MCAqIDEwMDA7IC8vIDE1IG1pbnV0ZXNcbiAgcHJpdmF0ZSByZWFkb25seSBJTlNJR0hUX1RUTCA9IDMwICogNjAgKiAxMDAwOyAvLyAzMCBtaW51dGVzXG5cbiAgc2V0RGF0YShrZXk6IHN0cmluZywgZGF0YTogUHJvZHVjdGlvbkRhdGEgfCBFbmVyZ3lEYXRhIHwgV2VhdGhlckRhdGEsIHR0bDogbnVtYmVyKSB7XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIHRoaXMuZGF0YUNhY2hlLnNldChrZXksIHtcbiAgICAgIGRhdGEsXG4gICAgICBsYXN0RmV0Y2hlZDogbm93LFxuICAgICAgZXhwaXJlczogRGF0ZS5ub3coKSArIHR0bFxuICAgIH0pO1xuICB9XG5cbiAgZ2V0RGF0YShrZXk6IHN0cmluZyk6IERhdGFDYWNoZUVudHJ5IHwgbnVsbCB7XG4gICAgY29uc3QgaXRlbSA9IHRoaXMuZGF0YUNhY2hlLmdldChrZXkpO1xuICAgIGlmICghaXRlbSB8fCBEYXRlLm5vdygpID4gaXRlbS5leHBpcmVzKSB7XG4gICAgICB0aGlzLmRhdGFDYWNoZS5kZWxldGUoa2V5KTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gaXRlbTtcbiAgfVxuXG4gIHNldEluc2lnaHQoZGF0YUhhc2g6IHN0cmluZywgaW5zaWdodDogSW5zaWdodERhdGEpIHtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gICAgdGhpcy5pbnNpZ2h0Q2FjaGUuc2V0KGRhdGFIYXNoLCB7XG4gICAgICBpbnNpZ2h0LFxuICAgICAgZGF0YUhhc2gsXG4gICAgICBsYXN0SW5zaWdodFJ1bjogbm93LFxuICAgICAgZXhwaXJlczogRGF0ZS5ub3coKSArIHRoaXMuSU5TSUdIVF9UVExcbiAgICB9KTtcbiAgfVxuXG4gIGdldEluc2lnaHQoZGF0YUhhc2g6IHN0cmluZyk6IEluc2lnaHRDYWNoZUVudHJ5IHwgbnVsbCB7XG4gICAgY29uc3QgaXRlbSA9IHRoaXMuaW5zaWdodENhY2hlLmdldChkYXRhSGFzaCk7XG4gICAgaWYgKCFpdGVtIHx8IERhdGUubm93KCkgPiBpdGVtLmV4cGlyZXMpIHtcbiAgICAgIHRoaXMuaW5zaWdodENhY2hlLmRlbGV0ZShkYXRhSGFzaCk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIGl0ZW07XG4gIH1cblxuICBnZXRMYXRlc3RJbnNpZ2h0KCk6IEluc2lnaHRDYWNoZUVudHJ5IHwgbnVsbCB7XG4gICAgbGV0IGxhdGVzdDogSW5zaWdodENhY2hlRW50cnkgfCBudWxsID0gbnVsbDtcbiAgICBsZXQgbGF0ZXN0VGltZSA9IDA7XG4gICAgXG4gICAgZm9yIChjb25zdCBlbnRyeSBvZiB0aGlzLmluc2lnaHRDYWNoZS52YWx1ZXMoKSkge1xuICAgICAgY29uc3QgZW50cnlUaW1lID0gbmV3IERhdGUoZW50cnkubGFzdEluc2lnaHRSdW4pLmdldFRpbWUoKTtcbiAgICAgIGlmIChlbnRyeVRpbWUgPiBsYXRlc3RUaW1lKSB7XG4gICAgICAgIGxhdGVzdCA9IGVudHJ5O1xuICAgICAgICBsYXRlc3RUaW1lID0gZW50cnlUaW1lO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gbGF0ZXN0O1xuICB9XG5cbiAgZ2V0VFRMKHNvdXJjZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBzd2l0Y2ggKHNvdXJjZSkge1xuICAgICAgY2FzZSAnZnJlZCc6IHJldHVybiB0aGlzLkZSRURfVFRMO1xuICAgICAgY2FzZSAnZWlhJzogcmV0dXJuIHRoaXMuRUlBX1RUTDtcbiAgICAgIGNhc2UgJ3dlYXRoZXInOiByZXR1cm4gdGhpcy5XRUFUSEVSX1RUTDtcbiAgICAgIGRlZmF1bHQ6IHJldHVybiB0aGlzLkVJQV9UVEw7XG4gICAgfVxuICB9XG59XG5cbmNvbnN0IGNhY2hlID0gbmV3IERhc2hib2FyZENhY2hlKCk7XG5cbi8qKlxuICogR2VuZXJhdGVzIFNIQS0xIGhhc2ggZnJvbSBjb21iaW5lZCBkYXRhIGZvciBjYWNoZSBpbnZhbGlkYXRpb25cbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVEYXRhSGFzaChwcm9kdWN0aW9uOiBQcm9kdWN0aW9uRGF0YSwgZW5lcmd5OiBFbmVyZ3lEYXRhLCB3ZWF0aGVyOiBXZWF0aGVyRGF0YSk6IHN0cmluZyB7XG4gIGNvbnN0IGNvbWJpbmVkRGF0YSA9IHtcbiAgICBwcm9kdWN0aW9uOiB7XG4gICAgICBpbmRleDogTWF0aC5yb3VuZChwcm9kdWN0aW9uLmluZGV4ICogMTApIC8gMTAsXG4gICAgICB0cmVuZDogcHJvZHVjdGlvbi50cmVuZFxuICAgIH0sXG4gICAgZW5lcmd5OiB7XG4gICAgICBjZW50c1Blckt3aDogTWF0aC5yb3VuZChlbmVyZ3kuY2VudHNQZXJLd2ggKiAxMDApIC8gMTAwLFxuICAgICAgdHJlbmQ6IGVuZXJneS50cmVuZFxuICAgIH0sXG4gICAgd2VhdGhlcjoge1xuICAgICAgdGVtcDogTWF0aC5yb3VuZCh3ZWF0aGVyLnRlbXAgLyA1KSAqIDUsIC8vIFJvdW5kIHRvIG5lYXJlc3QgNcKwXG4gICAgICBhbGVydDogd2VhdGhlci5hbGVydFxuICAgIH1cbiAgfTtcblxuICBjb25zdCBkYXRhU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoY29tYmluZWREYXRhLCBPYmplY3Qua2V5cyhjb21iaW5lZERhdGEpLnNvcnQoKSk7XG4gIHJldHVybiBjcnlwdG8uY3JlYXRlSGFzaCgnc2hhMScpLnVwZGF0ZShkYXRhU3RyaW5nKS5kaWdlc3QoJ2hleCcpO1xufVxuXG4vKipcbiAqIEZldGNoZXMgZGF0YSBmcm9tIGEgc3BlY2lmaWMgc291cmNlIHdpdGggY2FjaGluZyBhbmQgZXJyb3IgaGFuZGxpbmdcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZmV0Y2hXaXRoQ2FjaGU8VD4oXG4gIHNvdXJjZTogc3RyaW5nLFxuICBmZXRjaEZuOiAoKSA9PiBQcm9taXNlPFQ+LFxuICBmYWxsYmFjazogVFxuKTogUHJvbWlzZTx7IGRhdGE6IFQ7IGxhc3RGZXRjaGVkOiBzdHJpbmcgfT4ge1xuICAvLyBDaGVjayBjYWNoZSBmaXJzdFxuICBjb25zdCBjYWNoZWQgPSBjYWNoZS5nZXREYXRhKHNvdXJjZSk7XG4gIGlmIChjYWNoZWQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZGF0YTogY2FjaGVkLmRhdGEgYXMgVCxcbiAgICAgIGxhc3RGZXRjaGVkOiBjYWNoZWQubGFzdEZldGNoZWRcbiAgICB9O1xuICB9XG5cbiAgLy8gRmV0Y2ggZnJlc2ggZGF0YVxuICB0cnkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBmZXRjaEZuKCk7XG4gICAgY29uc3QgdHRsID0gY2FjaGUuZ2V0VFRMKHNvdXJjZSk7XG4gICAgY2FjaGUuc2V0RGF0YShzb3VyY2UsIGRhdGEsIHR0bCk7XG4gICAgXG4gICAgY29uc3QgY2FjaGVkRW50cnkgPSBjYWNoZS5nZXREYXRhKHNvdXJjZSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGRhdGEsXG4gICAgICBsYXN0RmV0Y2hlZDogY2FjaGVkRW50cnk/Lmxhc3RGZXRjaGVkIHx8IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihgRXJyb3IgZmV0Y2hpbmcgJHtzb3VyY2V9IGRhdGE6YCwgZXJyb3IpO1xuICAgIFxuICAgIC8vIFJldHVybiBmYWxsYmFjayBkYXRhXG4gICAgcmV0dXJuIHtcbiAgICAgIGRhdGE6IGZhbGxiYWNrLFxuICAgICAgbGFzdEZldGNoZWQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBGZXRjaGVzIGRhdGEgZnJvbSBhbGwgc291cmNlcyB3aXRoIGluZGl2aWR1YWwgY2FjaGluZyBhbmQgZXJyb3IgaGFuZGxpbmdcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZmV0Y2hBbGxEYXRhKCk6IFByb21pc2U8e1xuICBwcm9kdWN0aW9uOiBQcm9kdWN0aW9uRGF0YTtcbiAgZW5lcmd5OiBFbmVyZ3lEYXRhO1xuICB3ZWF0aGVyOiBXZWF0aGVyRGF0YTtcbiAgbGFzdEZldGNoZWQ6IHN0cmluZztcbn0+IHtcbiAgLy8gRmV0Y2ggYWxsIGRhdGEgc291cmNlcyBjb25jdXJyZW50bHkgd2l0aCBpbmRpdmlkdWFsIGNhY2hpbmdcbiAgY29uc3QgW3Byb2R1Y3Rpb25SZXN1bHQsIGVuZXJneVJlc3VsdCwgd2VhdGhlclJlc3VsdF0gPSBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQoW1xuICAgIGZldGNoV2l0aENhY2hlKCdmcmVkJywgZ2V0UHJvZHVjdGlvbkluZGV4LCB7IGluZGV4OiAxMDIuNCwgdHJlbmQ6ICfihpIgRGF0YSB1bmF2YWlsYWJsZScgfSksXG4gICAgZmV0Y2hXaXRoQ2FjaGUoJ2VpYScsIGdldEVuZXJneVByaWNlLCB7IGNlbnRzUGVyS3doOiAxMi41LCB0cmVuZDogJ3N0YWJsZScgYXMgY29uc3QgfSksXG4gICAgZmV0Y2hXaXRoQ2FjaGUoJ3dlYXRoZXInLCBnZXRMb2NhbFdlYXRoZXIsIHsgdGVtcDogNzUsIGFsZXJ0OiAnV2VhdGhlciBkYXRhIHVuYXZhaWxhYmxlJyB9KVxuICBdKTtcblxuICAvLyBFeHRyYWN0IGRhdGEgd2l0aCBmYWxsYmFja3NcbiAgY29uc3QgcHJvZHVjdGlvbiA9IHByb2R1Y3Rpb25SZXN1bHQuc3RhdHVzID09PSAnZnVsZmlsbGVkJyBcbiAgICA/IHByb2R1Y3Rpb25SZXN1bHQudmFsdWUuZGF0YSBcbiAgICA6IHsgaW5kZXg6IDEwMi40LCB0cmVuZDogJ+KGkiBEYXRhIHVuYXZhaWxhYmxlJyB9O1xuXG4gIGNvbnN0IGVuZXJneSA9IGVuZXJneVJlc3VsdC5zdGF0dXMgPT09ICdmdWxmaWxsZWQnIFxuICAgID8gZW5lcmd5UmVzdWx0LnZhbHVlLmRhdGEgXG4gICAgOiB7IGNlbnRzUGVyS3doOiAxMi41LCB0cmVuZDogJ3N0YWJsZScgYXMgY29uc3QgfTtcblxuICBjb25zdCB3ZWF0aGVyID0gd2VhdGhlclJlc3VsdC5zdGF0dXMgPT09ICdmdWxmaWxsZWQnIFxuICAgID8gd2VhdGhlclJlc3VsdC52YWx1ZS5kYXRhIFxuICAgIDogeyB0ZW1wOiA3NSwgYWxlcnQ6ICdXZWF0aGVyIGRhdGEgdW5hdmFpbGFibGUnIH07XG5cbiAgLy8gR2V0IHRoZSBtb3N0IHJlY2VudCBsYXN0RmV0Y2hlZCB0aW1lc3RhbXBcbiAgY29uc3QgdGltZXN0YW1wcyA9IFtcbiAgICBwcm9kdWN0aW9uUmVzdWx0LnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcgPyBwcm9kdWN0aW9uUmVzdWx0LnZhbHVlLmxhc3RGZXRjaGVkIDogbnVsbCxcbiAgICBlbmVyZ3lSZXN1bHQuc3RhdHVzID09PSAnZnVsZmlsbGVkJyA/IGVuZXJneVJlc3VsdC52YWx1ZS5sYXN0RmV0Y2hlZCA6IG51bGwsXG4gICAgd2VhdGhlclJlc3VsdC5zdGF0dXMgPT09ICdmdWxmaWxsZWQnID8gd2VhdGhlclJlc3VsdC52YWx1ZS5sYXN0RmV0Y2hlZCA6IG51bGxcbiAgXS5maWx0ZXIoQm9vbGVhbikgYXMgc3RyaW5nW107XG5cbiAgY29uc3QgbGFzdEZldGNoZWQgPSB0aW1lc3RhbXBzLmxlbmd0aCA+IDAgXG4gICAgPyBuZXcgRGF0ZShNYXRoLm1heCguLi50aW1lc3RhbXBzLm1hcCh0ID0+IG5ldyBEYXRlKHQpLmdldFRpbWUoKSkpKS50b0lTT1N0cmluZygpXG4gICAgOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG5cbiAgLy8gTG9nIGFueSBmYWlsdXJlcyBmb3IgZGVidWdnaW5nXG4gIGlmIChwcm9kdWN0aW9uUmVzdWx0LnN0YXR1cyA9PT0gJ3JlamVjdGVkJykge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1Byb2R1Y3Rpb24gZGF0YSBmZXRjaCBmYWlsZWQ6JywgcHJvZHVjdGlvblJlc3VsdC5yZWFzb24pO1xuICB9XG4gIGlmIChlbmVyZ3lSZXN1bHQuc3RhdHVzID09PSAncmVqZWN0ZWQnKSB7XG4gICAgY29uc29sZS5lcnJvcignRW5lcmd5IGRhdGEgZmV0Y2ggZmFpbGVkOicsIGVuZXJneVJlc3VsdC5yZWFzb24pO1xuICB9XG4gIGlmICh3ZWF0aGVyUmVzdWx0LnN0YXR1cyA9PT0gJ3JlamVjdGVkJykge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1dlYXRoZXIgZGF0YSBmZXRjaCBmYWlsZWQ6Jywgd2VhdGhlclJlc3VsdC5yZWFzb24pO1xuICB9XG5cbiAgcmV0dXJuIHsgcHJvZHVjdGlvbiwgZW5lcmd5LCB3ZWF0aGVyLCBsYXN0RmV0Y2hlZCB9O1xufVxuXG4vKipcbiAqIE1haW4gZGFzaGJvYXJkIEFQSSBoYW5kbGVyXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIoXG4gIHJlcTogTmV4dEFwaVJlcXVlc3QsXG4gIHJlczogTmV4dEFwaVJlc3BvbnNlPERhc2hib2FyZFJlc3BvbnNlPlxuKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgaXNNYW51YWxSZWZyZXNoID0gcmVxLnF1ZXJ5LnJlZnJlc2ggPT09ICd0cnVlJztcblxuICAgIC8vIEZldGNoIGFsbCBkYXRhIHNvdXJjZXNcbiAgICBjb25zdCB7IHByb2R1Y3Rpb24sIGVuZXJneSwgd2VhdGhlciwgbGFzdEZldGNoZWQgfSA9IGF3YWl0IGZldGNoQWxsRGF0YSgpO1xuXG4gICAgLy8gR2VuZXJhdGUgaGFzaCBmb3IgY2hhbmdlIGRldGVjdGlvblxuICAgIGNvbnN0IGN1cnJlbnREYXRhSGFzaCA9IGdlbmVyYXRlRGF0YUhhc2gocHJvZHVjdGlvbiwgZW5lcmd5LCB3ZWF0aGVyKTtcblxuICAgIC8vIENoZWNrIGlmIHdlIG5lZWQgbmV3IGluc2lnaHRzIChkYXRhIGNoYW5nZWQgb3IgbWFudWFsIHJlZnJlc2gpXG4gICAgY29uc3QgY2FjaGVkSW5zaWdodCA9IGNhY2hlLmdldEluc2lnaHQoY3VycmVudERhdGFIYXNoKTtcbiAgICBjb25zdCBuZWVkc0luc2lnaHRVcGRhdGUgPSBpc01hbnVhbFJlZnJlc2ggfHwgIWNhY2hlZEluc2lnaHQ7XG5cbiAgICBsZXQgaW5zaWdodDogSW5zaWdodERhdGE7XG4gICAgbGV0IGxhc3RJbnNpZ2h0UnVuOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuICAgIGlmIChuZWVkc0luc2lnaHRVcGRhdGUpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdHZW5lcmF0aW5nIG5ldyBpbnNpZ2h0cyB3aXRoIENsYXVkZSBBSS4uLicpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgaW5zaWdodCA9IGF3YWl0IGFuYWx5emVJbnNpZ2h0KHsgcHJvZHVjdGlvbiwgZW5lcmd5LCB3ZWF0aGVyIH0pO1xuICAgICAgICBjYWNoZS5zZXRJbnNpZ2h0KGN1cnJlbnREYXRhSGFzaCwgaW5zaWdodCk7XG4gICAgICAgIGNvbnN0IG5ld0NhY2hlZEluc2lnaHQgPSBjYWNoZS5nZXRJbnNpZ2h0KGN1cnJlbnREYXRhSGFzaCk7XG4gICAgICAgIGxhc3RJbnNpZ2h0UnVuID0gbmV3Q2FjaGVkSW5zaWdodD8ubGFzdEluc2lnaHRSdW4gfHwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignQ2xhdWRlIGluc2lnaHQgZ2VuZXJhdGlvbiBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgICBcbiAgICAgICAgLy8gVHJ5IHRvIHVzZSBhbnkgYXZhaWxhYmxlIGNhY2hlZCBpbnNpZ2h0XG4gICAgICAgIGNvbnN0IGxhdGVzdEluc2lnaHQgPSBjYWNoZS5nZXRMYXRlc3RJbnNpZ2h0KCk7XG4gICAgICAgIGlmIChsYXRlc3RJbnNpZ2h0KSB7XG4gICAgICAgICAgaW5zaWdodCA9IGxhdGVzdEluc2lnaHQuaW5zaWdodDtcbiAgICAgICAgICBsYXN0SW5zaWdodFJ1biA9IGxhdGVzdEluc2lnaHQubGFzdEluc2lnaHRSdW47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gR2VuZXJhdGUgY29udGV4dHVhbCBmYWxsYmFjayBiYXNlZCBvbiBkYXRhIHBhdHRlcm5zXG4gICAgICAgICAgaW5zaWdodCA9IGdlbmVyYXRlRmFsbGJhY2tJbnNpZ2h0KHByb2R1Y3Rpb24sIGVuZXJneSwgd2VhdGhlcik7XG4gICAgICAgICAgbGFzdEluc2lnaHRSdW4gPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFVzZSBjYWNoZWQgaW5zaWdodFxuICAgICAgaW5zaWdodCA9IGNhY2hlZEluc2lnaHQuaW5zaWdodDtcbiAgICAgIGxhc3RJbnNpZ2h0UnVuID0gY2FjaGVkSW5zaWdodC5sYXN0SW5zaWdodFJ1bjtcbiAgICB9XG5cbiAgICAvLyBDb25zdHJ1Y3QgcmVzcG9uc2UgZGF0YVxuICAgIGNvbnN0IGRhc2hib2FyZERhdGE6IERhc2hib2FyZERhdGEgPSB7XG4gICAgICBwcm9kdWN0aW9uLFxuICAgICAgZW5lcmd5LFxuICAgICAgd2VhdGhlcixcbiAgICAgIGluc2lnaHRcbiAgICB9O1xuXG4gICAgY29uc3QgcmVzcG9uc2U6IERhc2hib2FyZFJlc3BvbnNlID0ge1xuICAgICAgZGF0YTogZGFzaGJvYXJkRGF0YSxcbiAgICAgIGxhc3RGZXRjaGVkLFxuICAgICAgbGFzdEluc2lnaHRSdW5cbiAgICB9O1xuXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24ocmVzcG9uc2UpO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRGFzaGJvYXJkIEFQSSBlcnJvcjonLCBlcnJvcik7XG5cbiAgICAvLyBSZXR1cm4gZmFsbGJhY2sgcmVzcG9uc2Ugd2l0aCBwcm9wZXIgbWV0YWRhdGFcbiAgICBjb25zdCBmYWxsYmFja1Jlc3BvbnNlOiBEYXNoYm9hcmRSZXNwb25zZSA9IHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgcHJvZHVjdGlvbjogeyBpbmRleDogMTAyLjQsIHRyZW5kOiAn4oaSIERhdGEgdW5hdmFpbGFibGUnIH0sXG4gICAgICAgIGVuZXJneTogeyBjZW50c1Blckt3aDogMTIuNSwgdHJlbmQ6ICdzdGFibGUnIH0sXG4gICAgICAgIHdlYXRoZXI6IHsgdGVtcDogNzUsIGFsZXJ0OiAnRGF0YSB1bmF2YWlsYWJsZScgfSxcbiAgICAgICAgaW5zaWdodDoge1xuICAgICAgICAgIHN1bW1hcnk6ICdTeXN0ZW0gdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUnLFxuICAgICAgICAgIHJlY29tbWVuZGF0aW9uOiAnUGxlYXNlIHRyeSByZWZyZXNoaW5nIGluIGEgZmV3IG1pbnV0ZXMnXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBsYXN0RmV0Y2hlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgbGFzdEluc2lnaHRSdW46IG51bGxcbiAgICB9O1xuXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oZmFsbGJhY2tSZXNwb25zZSk7XG4gIH1cbn1cblxuLyoqXG4gKiBHZW5lcmF0ZXMgY29udGV4dHVhbCBmYWxsYmFjayBpbnNpZ2h0cyBiYXNlZCBvbiBkYXRhIHBhdHRlcm5zXG4gKi9cbmZ1bmN0aW9uIGdlbmVyYXRlRmFsbGJhY2tJbnNpZ2h0KFxuICBwcm9kdWN0aW9uOiBQcm9kdWN0aW9uRGF0YSwgXG4gIGVuZXJneTogRW5lcmd5RGF0YSwgXG4gIHdlYXRoZXI6IFdlYXRoZXJEYXRhXG4pOiBJbnNpZ2h0RGF0YSB7XG4gIGxldCBzdW1tYXJ5ID0gXCJEYXRhIGFuYWx5c2lzIHRlbXBvcmFyaWx5IHVuYXZhaWxhYmxlXCI7XG4gIGxldCByZWNvbW1lbmRhdGlvbiA9IFwiTW9uaXRvciBrZXkgbWV0cmljcyBhbmQgYWRqdXN0IG9wZXJhdGlvbnMgYXMgbmVlZGVkXCI7XG5cbiAgLy8gUHJvdmlkZSBiYXNpYyBpbnNpZ2h0cyBiYXNlZCBvbiBkYXRhIHBhdHRlcm5zXG4gIGlmICh3ZWF0aGVyLnRlbXAgPj0gMTAwKSB7XG4gICAgc3VtbWFyeSA9IFwiRXh0cmVtZSBoZWF0IGNvbmRpdGlvbnMgZGV0ZWN0ZWRcIjtcbiAgICByZWNvbW1lbmRhdGlvbiA9IFwiQ29uc2lkZXIgc2hpZnRpbmcgb3BlcmF0aW9ucyB0byBjb29sZXIgaG91cnMgdG8gcmVkdWNlIGVuZXJneSBjb3N0c1wiO1xuICB9IGVsc2UgaWYgKGVuZXJneS50cmVuZCA9PT0gJ3VwJykge1xuICAgIHN1bW1hcnkgPSBcIkVuZXJneSBjb3N0cyB0cmVuZGluZyB1cHdhcmRcIjtcbiAgICByZWNvbW1lbmRhdGlvbiA9IFwiT3B0aW1pemUgZW5lcmd5IHVzYWdlIGFuZCBjb25zaWRlciBvZmYtcGVhayBzY2hlZHVsaW5nXCI7XG4gIH0gZWxzZSBpZiAod2VhdGhlci5hbGVydCAhPT0gJ25vbmUnICYmIHdlYXRoZXIuYWxlcnQgIT09ICdXZWF0aGVyIGRhdGEgdW5hdmFpbGFibGUnKSB7XG4gICAgc3VtbWFyeSA9IFwiV2VhdGhlciBhbGVydCBhY3RpdmVcIjtcbiAgICByZWNvbW1lbmRhdGlvbiA9IFwiTW9uaXRvciB3ZWF0aGVyIGNvbmRpdGlvbnMgYW5kIHByZXBhcmUgY29udGluZ2VuY3kgcGxhbnNcIjtcbiAgfSBlbHNlIGlmIChwcm9kdWN0aW9uLnRyZW5kLmluY2x1ZGVzKCfihpMnKSkge1xuICAgIHN1bW1hcnkgPSBcIlByb2R1Y3Rpb24gaW5kZXggZGVjbGluaW5nXCI7XG4gICAgcmVjb21tZW5kYXRpb24gPSBcIlJldmlldyBwcm9kdWN0aW9uIHByb2Nlc3NlcyBhbmQgaWRlbnRpZnkgaW1wcm92ZW1lbnQgb3Bwb3J0dW5pdGllc1wiO1xuICB9IGVsc2UgaWYgKHByb2R1Y3Rpb24udHJlbmQuaW5jbHVkZXMoJ+KGkScpKSB7XG4gICAgc3VtbWFyeSA9IFwiUHJvZHVjdGlvbiBwZXJmb3JtaW5nIHdlbGxcIjtcbiAgICByZWNvbW1lbmRhdGlvbiA9IFwiTWFpbnRhaW4gY3VycmVudCBlZmZpY2llbmN5IHdoaWxlIG1vbml0b3JpbmcgZW5lcmd5IGNvc3RzXCI7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHN1bW1hcnksXG4gICAgcmVjb21tZW5kYXRpb25cbiAgfTtcbn0iXSwibmFtZXMiOlsiY3J5cHRvIiwiZ2V0UHJvZHVjdGlvbkluZGV4IiwiZ2V0RW5lcmd5UHJpY2UiLCJnZXRMb2NhbFdlYXRoZXIiLCJhbmFseXplSW5zaWdodCIsIkRhc2hib2FyZENhY2hlIiwic2V0RGF0YSIsImtleSIsImRhdGEiLCJ0dGwiLCJub3ciLCJEYXRlIiwidG9JU09TdHJpbmciLCJkYXRhQ2FjaGUiLCJzZXQiLCJsYXN0RmV0Y2hlZCIsImV4cGlyZXMiLCJnZXREYXRhIiwiaXRlbSIsImdldCIsImRlbGV0ZSIsInNldEluc2lnaHQiLCJkYXRhSGFzaCIsImluc2lnaHQiLCJpbnNpZ2h0Q2FjaGUiLCJsYXN0SW5zaWdodFJ1biIsIklOU0lHSFRfVFRMIiwiZ2V0SW5zaWdodCIsImdldExhdGVzdEluc2lnaHQiLCJsYXRlc3QiLCJsYXRlc3RUaW1lIiwiZW50cnkiLCJ2YWx1ZXMiLCJlbnRyeVRpbWUiLCJnZXRUaW1lIiwiZ2V0VFRMIiwic291cmNlIiwiRlJFRF9UVEwiLCJFSUFfVFRMIiwiV0VBVEhFUl9UVEwiLCJNYXAiLCJjYWNoZSIsImdlbmVyYXRlRGF0YUhhc2giLCJwcm9kdWN0aW9uIiwiZW5lcmd5Iiwid2VhdGhlciIsImNvbWJpbmVkRGF0YSIsImluZGV4IiwiTWF0aCIsInJvdW5kIiwidHJlbmQiLCJjZW50c1Blckt3aCIsInRlbXAiLCJhbGVydCIsImRhdGFTdHJpbmciLCJKU09OIiwic3RyaW5naWZ5IiwiT2JqZWN0Iiwia2V5cyIsInNvcnQiLCJjcmVhdGVIYXNoIiwidXBkYXRlIiwiZGlnZXN0IiwiZmV0Y2hXaXRoQ2FjaGUiLCJmZXRjaEZuIiwiZmFsbGJhY2siLCJjYWNoZWQiLCJjYWNoZWRFbnRyeSIsImVycm9yIiwiY29uc29sZSIsImZldGNoQWxsRGF0YSIsInByb2R1Y3Rpb25SZXN1bHQiLCJlbmVyZ3lSZXN1bHQiLCJ3ZWF0aGVyUmVzdWx0IiwiUHJvbWlzZSIsImFsbFNldHRsZWQiLCJzdGF0dXMiLCJ2YWx1ZSIsInRpbWVzdGFtcHMiLCJmaWx0ZXIiLCJCb29sZWFuIiwibGVuZ3RoIiwibWF4IiwibWFwIiwidCIsInJlYXNvbiIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJpc01hbnVhbFJlZnJlc2giLCJxdWVyeSIsInJlZnJlc2giLCJjdXJyZW50RGF0YUhhc2giLCJjYWNoZWRJbnNpZ2h0IiwibmVlZHNJbnNpZ2h0VXBkYXRlIiwibG9nIiwibmV3Q2FjaGVkSW5zaWdodCIsImxhdGVzdEluc2lnaHQiLCJnZW5lcmF0ZUZhbGxiYWNrSW5zaWdodCIsImRhc2hib2FyZERhdGEiLCJyZXNwb25zZSIsImpzb24iLCJmYWxsYmFja1Jlc3BvbnNlIiwic3VtbWFyeSIsInJlY29tbWVuZGF0aW9uIiwiaW5jbHVkZXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/dashboard.ts\n");

/***/ }),

/***/ "(api)/./src/lib/fetchEia.ts":
/*!*****************************!*\
  !*** ./src/lib/fetchEia.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearEnergyPriceCache: () => (/* binding */ clearEnergyPriceCache),\n/* harmony export */   getEnergyPrice: () => (/* binding */ getEnergyPrice)\n/* harmony export */ });\n// Simple in-memory cache with TTL\nclass SimpleCache {\n    set(key, data, ttlMs) {\n        this.cache.set(key, {\n            data,\n            expires: Date.now() + ttlMs\n        });\n    }\n    get(key) {\n        const item = this.cache.get(key);\n        if (!item) return null;\n        if (Date.now() > item.expires) {\n            this.cache.delete(key);\n            return null;\n        }\n        return item.data;\n    }\n    constructor(){\n        this.cache = new Map();\n    }\n}\nconst cache = new SimpleCache();\nconst CACHE_TTL = 10 * 60 * 1000; // 10 minutes in milliseconds\nconst CACHE_KEY = \"eia_texas_electricity_price\";\n/**\n * Fetches current Texas retail electricity pricing data from the EIA API\n * \n * @returns Promise<EnergyPriceData> Object containing current price in cents per kWh and trend\n * @throws Error when API key is missing or API request fails\n * \n * @example\n * ```typescript\n * const energyData = await getEnergyPrice();\n * console.log(`Current price: ${energyData.centsPerKwh}¢/kWh, Trend: ${energyData.trend}`);\n * ```\n */ async function getEnergyPrice() {\n    // Check cache first\n    const cachedData = cache.get(CACHE_KEY);\n    if (cachedData) {\n        return cachedData;\n    }\n    const apiKey = process.env.EIA_API_KEY;\n    if (!apiKey) {\n        throw new Error(\"EIA_API_KEY environment variable is required\");\n    }\n    try {\n        // EIA API endpoint for Texas retail electricity prices\n        // Series ID: ELEC.PRICE.TX-RES.M (Texas residential retail electricity price)\n        const url = \"https://api.eia.gov/v2/electricity/retail-sales/data/\";\n        const params = new URLSearchParams({\n            \"api_key\": apiKey,\n            \"frequency\": \"monthly\",\n            \"data[0]\": \"price\",\n            \"facets[stateid][]\": \"TX\",\n            \"facets[sectorid][]\": \"RES\",\n            \"sort[0][column]\": \"period\",\n            \"sort[0][direction]\": \"desc\",\n            \"offset\": \"0\",\n            \"length\": \"3\" // Get last 3 months for trend calculation\n        });\n        const response = await fetch(`${url}?${params}`, {\n            method: \"GET\",\n            headers: {\n                \"Accept\": \"application/json\",\n                \"User-Agent\": \"OpsIntel-Dashboard/1.0\"\n            }\n        });\n        if (!response.ok) {\n            if (response.status === 429) {\n                throw new Error(\"EIA API rate limit exceeded. Please try again later.\");\n            }\n            if (response.status === 403) {\n                throw new Error(\"Invalid EIA API key or access denied\");\n            }\n            throw new Error(`EIA API error: ${response.status} ${response.statusText}`);\n        }\n        const data = await response.json();\n        if (!data.response?.data || data.response.data.length === 0) {\n            throw new Error(\"No electricity pricing data available from EIA API\");\n        }\n        const priceData = data.response.data[0]?.data;\n        if (!priceData || priceData.length === 0) {\n            throw new Error(\"No valid pricing observations found\");\n        }\n        // Sort by period to ensure we have the most recent data first\n        const sortedData = priceData.filter((point)=>point.value !== null && !isNaN(point.value)).sort((a, b)=>b.period.localeCompare(a.period));\n        if (sortedData.length === 0) {\n            throw new Error(\"No valid pricing data points available\");\n        }\n        const latestPrice = sortedData[0].value;\n        if (isNaN(latestPrice) || latestPrice <= 0) {\n            throw new Error(\"Invalid electricity price value received\");\n        }\n        let trend = \"stable\";\n        // Calculate trend if we have at least 2 data points\n        if (sortedData.length >= 2) {\n            const previousPrice = sortedData[1].value;\n            if (!isNaN(previousPrice) && previousPrice > 0) {\n                const percentChange = (latestPrice - previousPrice) / previousPrice * 100;\n                // Consider changes > 2% as significant trend\n                if (percentChange > 2) {\n                    trend = \"up\";\n                } else if (percentChange < -2) {\n                    trend = \"down\";\n                } else {\n                    trend = \"stable\";\n                }\n            }\n        }\n        const result = {\n            centsPerKwh: Math.round(latestPrice * 100) / 100,\n            trend\n        };\n        // Cache the result\n        cache.set(CACHE_KEY, result, CACHE_TTL);\n        return result;\n    } catch (error) {\n        console.error(\"Error fetching EIA electricity pricing data:\", error);\n        // Return fallback data in case of error\n        return {\n            centsPerKwh: 12.5,\n            trend: \"stable\"\n        };\n    }\n}\n/**\n * Utility function to clear the energy price cache\n * Useful for testing or forcing fresh data retrieval\n */ function clearEnergyPriceCache() {\n    cache.get(CACHE_KEY) && cache.set(CACHE_KEY, null, 0);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LnRzP2NjMzciXSwic291cmNlc0NvbnRlbnQiOlsiaW50ZXJmYWNlIEVpYURhdGFQb2ludCB7XG4gIHBlcmlvZDogc3RyaW5nO1xuICB2YWx1ZTogbnVtYmVyO1xufVxuXG5pbnRlcmZhY2UgRWlhUmVzcG9uc2Uge1xuICByZXNwb25zZToge1xuICAgIGRhdGE6IEFycmF5PHtcbiAgICAgIGRhdGE6IEVpYURhdGFQb2ludFtdO1xuICAgIH0+O1xuICB9O1xufVxuXG5pbnRlcmZhY2UgRW5lcmd5UHJpY2VEYXRhIHtcbiAgY2VudHNQZXJLd2g6IG51bWJlcjtcbiAgdHJlbmQ6ICd1cCcgfCAnZG93bicgfCAnc3RhYmxlJztcbn1cblxuLy8gU2ltcGxlIGluLW1lbW9yeSBjYWNoZSB3aXRoIFRUTFxuY2xhc3MgU2ltcGxlQ2FjaGUge1xuICBwcml2YXRlIGNhY2hlID0gbmV3IE1hcDxzdHJpbmcsIHsgZGF0YTogYW55OyBleHBpcmVzOiBudW1iZXIgfT4oKTtcblxuICBzZXQoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSwgdHRsTXM6IG51bWJlcikge1xuICAgIHRoaXMuY2FjaGUuc2V0KGtleSwge1xuICAgICAgZGF0YSxcbiAgICAgIGV4cGlyZXM6IERhdGUubm93KCkgKyB0dGxNc1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0KGtleTogc3RyaW5nKSB7XG4gICAgY29uc3QgaXRlbSA9IHRoaXMuY2FjaGUuZ2V0KGtleSk7XG4gICAgaWYgKCFpdGVtKSByZXR1cm4gbnVsbDtcbiAgICBcbiAgICBpZiAoRGF0ZS5ub3coKSA+IGl0ZW0uZXhwaXJlcykge1xuICAgICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gaXRlbS5kYXRhO1xuICB9XG59XG5cbmNvbnN0IGNhY2hlID0gbmV3IFNpbXBsZUNhY2hlKCk7XG5jb25zdCBDQUNIRV9UVEwgPSAxMCAqIDYwICogMTAwMDsgLy8gMTAgbWludXRlcyBpbiBtaWxsaXNlY29uZHNcbmNvbnN0IENBQ0hFX0tFWSA9ICdlaWFfdGV4YXNfZWxlY3RyaWNpdHlfcHJpY2UnO1xuXG4vKipcbiAqIEZldGNoZXMgY3VycmVudCBUZXhhcyByZXRhaWwgZWxlY3RyaWNpdHkgcHJpY2luZyBkYXRhIGZyb20gdGhlIEVJQSBBUElcbiAqIFxuICogQHJldHVybnMgUHJvbWlzZTxFbmVyZ3lQcmljZURhdGE+IE9iamVjdCBjb250YWluaW5nIGN1cnJlbnQgcHJpY2UgaW4gY2VudHMgcGVyIGtXaCBhbmQgdHJlbmRcbiAqIEB0aHJvd3MgRXJyb3Igd2hlbiBBUEkga2V5IGlzIG1pc3Npbmcgb3IgQVBJIHJlcXVlc3QgZmFpbHNcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGVuZXJneURhdGEgPSBhd2FpdCBnZXRFbmVyZ3lQcmljZSgpO1xuICogY29uc29sZS5sb2coYEN1cnJlbnQgcHJpY2U6ICR7ZW5lcmd5RGF0YS5jZW50c1Blckt3aH3Coi9rV2gsIFRyZW5kOiAke2VuZXJneURhdGEudHJlbmR9YCk7XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEVuZXJneVByaWNlKCk6IFByb21pc2U8RW5lcmd5UHJpY2VEYXRhPiB7XG4gIC8vIENoZWNrIGNhY2hlIGZpcnN0XG4gIGNvbnN0IGNhY2hlZERhdGEgPSBjYWNoZS5nZXQoQ0FDSEVfS0VZKTtcbiAgaWYgKGNhY2hlZERhdGEpIHtcbiAgICByZXR1cm4gY2FjaGVkRGF0YTtcbiAgfVxuXG4gIGNvbnN0IGFwaUtleSA9IHByb2Nlc3MuZW52LkVJQV9BUElfS0VZO1xuICBpZiAoIWFwaUtleSkge1xuICAgIHRocm93IG5ldyBFcnJvcignRUlBX0FQSV9LRVkgZW52aXJvbm1lbnQgdmFyaWFibGUgaXMgcmVxdWlyZWQnKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgLy8gRUlBIEFQSSBlbmRwb2ludCBmb3IgVGV4YXMgcmV0YWlsIGVsZWN0cmljaXR5IHByaWNlc1xuICAgIC8vIFNlcmllcyBJRDogRUxFQy5QUklDRS5UWC1SRVMuTSAoVGV4YXMgcmVzaWRlbnRpYWwgcmV0YWlsIGVsZWN0cmljaXR5IHByaWNlKVxuICAgIGNvbnN0IHVybCA9ICdodHRwczovL2FwaS5laWEuZ292L3YyL2VsZWN0cmljaXR5L3JldGFpbC1zYWxlcy9kYXRhLyc7XG4gICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAnYXBpX2tleSc6IGFwaUtleSxcbiAgICAgICdmcmVxdWVuY3knOiAnbW9udGhseScsXG4gICAgICAnZGF0YVswXSc6ICdwcmljZScsXG4gICAgICAnZmFjZXRzW3N0YXRlaWRdW10nOiAnVFgnLFxuICAgICAgJ2ZhY2V0c1tzZWN0b3JpZF1bXSc6ICdSRVMnLCAvLyBSZXNpZGVudGlhbCBzZWN0b3JcbiAgICAgICdzb3J0WzBdW2NvbHVtbl0nOiAncGVyaW9kJyxcbiAgICAgICdzb3J0WzBdW2RpcmVjdGlvbl0nOiAnZGVzYycsXG4gICAgICAnb2Zmc2V0JzogJzAnLFxuICAgICAgJ2xlbmd0aCc6ICczJyAvLyBHZXQgbGFzdCAzIG1vbnRocyBmb3IgdHJlbmQgY2FsY3VsYXRpb25cbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dXJsfT8ke3BhcmFtc31gLCB7XG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnVXNlci1BZ2VudCc6ICdPcHNJbnRlbC1EYXNoYm9hcmQvMS4wJ1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDI5KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRUlBIEFQSSByYXRlIGxpbWl0IGV4Y2VlZGVkLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLicpO1xuICAgICAgfVxuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAzKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBFSUEgQVBJIGtleSBvciBhY2Nlc3MgZGVuaWVkJyk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVJQSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgfVxuXG4gICAgY29uc3QgZGF0YTogRWlhUmVzcG9uc2UgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgXG4gICAgaWYgKCFkYXRhLnJlc3BvbnNlPy5kYXRhIHx8IGRhdGEucmVzcG9uc2UuZGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gZWxlY3RyaWNpdHkgcHJpY2luZyBkYXRhIGF2YWlsYWJsZSBmcm9tIEVJQSBBUEknKTtcbiAgICB9XG5cbiAgICBjb25zdCBwcmljZURhdGEgPSBkYXRhLnJlc3BvbnNlLmRhdGFbMF0/LmRhdGE7XG4gICAgaWYgKCFwcmljZURhdGEgfHwgcHJpY2VEYXRhLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB2YWxpZCBwcmljaW5nIG9ic2VydmF0aW9ucyBmb3VuZCcpO1xuICAgIH1cblxuICAgIC8vIFNvcnQgYnkgcGVyaW9kIHRvIGVuc3VyZSB3ZSBoYXZlIHRoZSBtb3N0IHJlY2VudCBkYXRhIGZpcnN0XG4gICAgY29uc3Qgc29ydGVkRGF0YSA9IHByaWNlRGF0YVxuICAgICAgLmZpbHRlcihwb2ludCA9PiBwb2ludC52YWx1ZSAhPT0gbnVsbCAmJiAhaXNOYU4ocG9pbnQudmFsdWUpKVxuICAgICAgLnNvcnQoKGEsIGIpID0+IGIucGVyaW9kLmxvY2FsZUNvbXBhcmUoYS5wZXJpb2QpKTtcblxuICAgIGlmIChzb3J0ZWREYXRhLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB2YWxpZCBwcmljaW5nIGRhdGEgcG9pbnRzIGF2YWlsYWJsZScpO1xuICAgIH1cblxuICAgIGNvbnN0IGxhdGVzdFByaWNlID0gc29ydGVkRGF0YVswXS52YWx1ZTtcbiAgICBcbiAgICBpZiAoaXNOYU4obGF0ZXN0UHJpY2UpIHx8IGxhdGVzdFByaWNlIDw9IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBlbGVjdHJpY2l0eSBwcmljZSB2YWx1ZSByZWNlaXZlZCcpO1xuICAgIH1cblxuICAgIGxldCB0cmVuZDogJ3VwJyB8ICdkb3duJyB8ICdzdGFibGUnID0gJ3N0YWJsZSc7XG4gICAgXG4gICAgLy8gQ2FsY3VsYXRlIHRyZW5kIGlmIHdlIGhhdmUgYXQgbGVhc3QgMiBkYXRhIHBvaW50c1xuICAgIGlmIChzb3J0ZWREYXRhLmxlbmd0aCA+PSAyKSB7XG4gICAgICBjb25zdCBwcmV2aW91c1ByaWNlID0gc29ydGVkRGF0YVsxXS52YWx1ZTtcbiAgICAgIFxuICAgICAgaWYgKCFpc05hTihwcmV2aW91c1ByaWNlKSAmJiBwcmV2aW91c1ByaWNlID4gMCkge1xuICAgICAgICBjb25zdCBwZXJjZW50Q2hhbmdlID0gKChsYXRlc3RQcmljZSAtIHByZXZpb3VzUHJpY2UpIC8gcHJldmlvdXNQcmljZSkgKiAxMDA7XG4gICAgICAgIFxuICAgICAgICAvLyBDb25zaWRlciBjaGFuZ2VzID4gMiUgYXMgc2lnbmlmaWNhbnQgdHJlbmRcbiAgICAgICAgaWYgKHBlcmNlbnRDaGFuZ2UgPiAyKSB7XG4gICAgICAgICAgdHJlbmQgPSAndXAnO1xuICAgICAgICB9IGVsc2UgaWYgKHBlcmNlbnRDaGFuZ2UgPCAtMikge1xuICAgICAgICAgIHRyZW5kID0gJ2Rvd24nO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRyZW5kID0gJ3N0YWJsZSc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHQ6IEVuZXJneVByaWNlRGF0YSA9IHtcbiAgICAgIGNlbnRzUGVyS3doOiBNYXRoLnJvdW5kKGxhdGVzdFByaWNlICogMTAwKSAvIDEwMCwgLy8gUm91bmQgdG8gMiBkZWNpbWFsIHBsYWNlc1xuICAgICAgdHJlbmRcbiAgICB9O1xuXG4gICAgLy8gQ2FjaGUgdGhlIHJlc3VsdFxuICAgIGNhY2hlLnNldChDQUNIRV9LRVksIHJlc3VsdCwgQ0FDSEVfVFRMKTtcbiAgICBcbiAgICByZXR1cm4gcmVzdWx0O1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgRUlBIGVsZWN0cmljaXR5IHByaWNpbmcgZGF0YTonLCBlcnJvcik7XG4gICAgXG4gICAgLy8gUmV0dXJuIGZhbGxiYWNrIGRhdGEgaW4gY2FzZSBvZiBlcnJvclxuICAgIHJldHVybiB7XG4gICAgICBjZW50c1Blckt3aDogMTIuNSxcbiAgICAgIHRyZW5kOiAnc3RhYmxlJ1xuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBVdGlsaXR5IGZ1bmN0aW9uIHRvIGNsZWFyIHRoZSBlbmVyZ3kgcHJpY2UgY2FjaGVcbiAqIFVzZWZ1bCBmb3IgdGVzdGluZyBvciBmb3JjaW5nIGZyZXNoIGRhdGEgcmV0cmlldmFsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbGVhckVuZXJneVByaWNlQ2FjaGUoKTogdm9pZCB7XG4gIGNhY2hlLmdldChDQUNIRV9LRVkpICYmIGNhY2hlLnNldChDQUNIRV9LRVksIG51bGwsIDApO1xufSJdLCJuYW1lcyI6WyJTaW1wbGVDYWNoZSIsInNldCIsImtleSIsImRhdGEiLCJ0dGxNcyIsImNhY2hlIiwiZXhwaXJlcyIsIkRhdGUiLCJub3ciLCJnZXQiLCJpdGVtIiwiZGVsZXRlIiwiTWFwIiwiQ0FDSEVfVFRMIiwiQ0FDSEVfS0VZIiwiZ2V0RW5lcmd5UHJpY2UiLCJjYWNoZWREYXRhIiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIkVJQV9BUElfS0VZIiwiRXJyb3IiLCJ1cmwiLCJwYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsIm9rIiwic3RhdHVzIiwic3RhdHVzVGV4dCIsImpzb24iLCJsZW5ndGgiLCJwcmljZURhdGEiLCJzb3J0ZWREYXRhIiwiZmlsdGVyIiwicG9pbnQiLCJ2YWx1ZSIsImlzTmFOIiwic29ydCIsImEiLCJiIiwicGVyaW9kIiwibG9jYWxlQ29tcGFyZSIsImxhdGVzdFByaWNlIiwidHJlbmQiLCJwcmV2aW91c1ByaWNlIiwicGVyY2VudENoYW5nZSIsInJlc3VsdCIsImNlbnRzUGVyS3doIiwiTWF0aCIsInJvdW5kIiwiZXJyb3IiLCJjb25zb2xlIiwiY2xlYXJFbmVyZ3lQcmljZUNhY2hlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/lib/fetchEia.ts\n");

/***/ }),

/***/ "(api)/./src/lib/fetchFred.ts":
/*!******************************!*\
  !*** ./src/lib/fetchFred.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getProductionIndex: () => (/* binding */ getProductionIndex)\n/* harmony export */ });\n// Simple in-memory cache with TTL\nclass SimpleCache {\n    set(key, data, ttlMs) {\n        this.cache.set(key, {\n            data,\n            expires: Date.now() + ttlMs\n        });\n    }\n    get(key) {\n        const item = this.cache.get(key);\n        if (!item) return null;\n        if (Date.now() > item.expires) {\n            this.cache.delete(key);\n            return null;\n        }\n        return item.data;\n    }\n    constructor(){\n        this.cache = new Map();\n    }\n}\nconst cache = new SimpleCache();\nconst CACHE_TTL = 60 * 60 * 1000; // 1 hour in milliseconds\nconst CACHE_KEY = \"fred_production_index\";\nasync function getProductionIndex() {\n    // Check cache first\n    const cachedData = cache.get(CACHE_KEY);\n    if (cachedData) {\n        return cachedData;\n    }\n    const apiKey = process.env.FRED_API_KEY;\n    if (!apiKey) {\n        throw new Error(\"FRED_API_KEY environment variable is required\");\n    }\n    try {\n        // Fetch last 3 months of data to calculate MoM trend\n        const url = `https://api.stlouisfed.org/fred/series/observations`;\n        const params = new URLSearchParams({\n            series_id: \"INDPRO\",\n            api_key: apiKey,\n            file_type: \"json\",\n            limit: \"3\",\n            sort_order: \"desc\",\n            observation_start: new Date(Date.now() - 90 * 24 * 60 * 60 * 1000).toISOString().split(\"T\")[0]\n        });\n        const response = await fetch(`${url}?${params}`);\n        if (!response.ok) {\n            throw new Error(`FRED API error: ${response.status} ${response.statusText}`);\n        }\n        const data = await response.json();\n        if (!data.observations || data.observations.length === 0) {\n            throw new Error(\"No production data available from FRED API\");\n        }\n        // Filter out any observations with \".\" (missing data)\n        const validObservations = data.observations.filter((obs)=>obs.value !== \".\").sort((a, b)=>new Date(b.date).getTime() - new Date(a.date).getTime());\n        if (validObservations.length < 1) {\n            throw new Error(\"No valid production data available\");\n        }\n        const latestValue = parseFloat(validObservations[0].value);\n        if (isNaN(latestValue)) {\n            throw new Error(\"Invalid production index value received\");\n        }\n        let trend = \"→ No data\";\n        // Calculate MoM trend if we have at least 2 data points\n        if (validObservations.length >= 2) {\n            const previousValue = parseFloat(validObservations[1].value);\n            if (!isNaN(previousValue) && previousValue !== 0) {\n                const percentChange = (latestValue - previousValue) / previousValue * 100;\n                const sign = percentChange > 0 ? \"↑\" : percentChange < 0 ? \"↓\" : \"→\";\n                trend = `${sign} ${Math.abs(percentChange).toFixed(1)}% MoM`;\n            }\n        }\n        const result = {\n            index: Math.round(latestValue * 10) / 10,\n            trend\n        };\n        // Cache the result\n        cache.set(CACHE_KEY, result, CACHE_TTL);\n        return result;\n    } catch (error) {\n        console.error(\"Error fetching FRED production data:\", error);\n        // Return fallback data in case of error\n        return {\n            index: 102.4,\n            trend: \"→ Data unavailable\"\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbGliL2ZldGNoRnJlZC50cyIsIm1hcHBpbmdzIjoiOzs7O0FBY0Esa0NBQWtDO0FBQ2xDLE1BQU1BO0lBR0pDLElBQUlDLEdBQVcsRUFBRUMsSUFBUyxFQUFFQyxLQUFhLEVBQUU7UUFDekMsSUFBSSxDQUFDQyxLQUFLLENBQUNKLEdBQUcsQ0FBQ0MsS0FBSztZQUNsQkM7WUFDQUcsU0FBU0MsS0FBS0MsR0FBRyxLQUFLSjtRQUN4QjtJQUNGO0lBRUFLLElBQUlQLEdBQVcsRUFBRTtRQUNmLE1BQU1RLE9BQU8sSUFBSSxDQUFDTCxLQUFLLENBQUNJLEdBQUcsQ0FBQ1A7UUFDNUIsSUFBSSxDQUFDUSxNQUFNLE9BQU87UUFFbEIsSUFBSUgsS0FBS0MsR0FBRyxLQUFLRSxLQUFLSixPQUFPLEVBQUU7WUFDN0IsSUFBSSxDQUFDRCxLQUFLLENBQUNNLE1BQU0sQ0FBQ1Q7WUFDbEIsT0FBTztRQUNUO1FBRUEsT0FBT1EsS0FBS1AsSUFBSTtJQUNsQjs7YUFuQlFFLFFBQVEsSUFBSU87O0FBb0J0QjtBQUVBLE1BQU1QLFFBQVEsSUFBSUw7QUFDbEIsTUFBTWEsWUFBWSxLQUFLLEtBQUssTUFBTSx5QkFBeUI7QUFDM0QsTUFBTUMsWUFBWTtBQUVYLGVBQWVDO0lBQ3BCLG9CQUFvQjtJQUNwQixNQUFNQyxhQUFhWCxNQUFNSSxHQUFHLENBQUNLO0lBQzdCLElBQUlFLFlBQVk7UUFDZCxPQUFPQTtJQUNUO0lBRUEsTUFBTUMsU0FBU0MsUUFBUUMsR0FBRyxDQUFDQyxZQUFZO0lBQ3ZDLElBQUksQ0FBQ0gsUUFBUTtRQUNYLE1BQU0sSUFBSUksTUFBTTtJQUNsQjtJQUVBLElBQUk7UUFDRixxREFBcUQ7UUFDckQsTUFBTUMsTUFBTSxDQUFDLG1EQUFtRCxDQUFDO1FBQ2pFLE1BQU1DLFNBQVMsSUFBSUMsZ0JBQWdCO1lBQ2pDQyxXQUFXO1lBQ1hDLFNBQVNUO1lBQ1RVLFdBQVc7WUFDWEMsT0FBTztZQUNQQyxZQUFZO1lBQ1pDLG1CQUFtQixJQUFJdkIsS0FBS0EsS0FBS0MsR0FBRyxLQUFLLEtBQUssS0FBSyxLQUFLLEtBQUssTUFBTXVCLFdBQVcsR0FBR0MsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQ2hHO1FBRUEsTUFBTUMsV0FBVyxNQUFNQyxNQUFNLENBQUMsRUFBRVosSUFBSSxDQUFDLEVBQUVDLE9BQU8sQ0FBQztRQUUvQyxJQUFJLENBQUNVLFNBQVNFLEVBQUUsRUFBRTtZQUNoQixNQUFNLElBQUlkLE1BQU0sQ0FBQyxnQkFBZ0IsRUFBRVksU0FBU0csTUFBTSxDQUFDLENBQUMsRUFBRUgsU0FBU0ksVUFBVSxDQUFDLENBQUM7UUFDN0U7UUFFQSxNQUFNbEMsT0FBcUIsTUFBTThCLFNBQVNLLElBQUk7UUFFOUMsSUFBSSxDQUFDbkMsS0FBS29DLFlBQVksSUFBSXBDLEtBQUtvQyxZQUFZLENBQUNDLE1BQU0sS0FBSyxHQUFHO1lBQ3hELE1BQU0sSUFBSW5CLE1BQU07UUFDbEI7UUFFQSxzREFBc0Q7UUFDdEQsTUFBTW9CLG9CQUFvQnRDLEtBQUtvQyxZQUFZLENBQ3hDRyxNQUFNLENBQUNDLENBQUFBLE1BQU9BLElBQUlDLEtBQUssS0FBSyxLQUM1QkMsSUFBSSxDQUFDLENBQUNDLEdBQUdDLElBQU0sSUFBSXhDLEtBQUt3QyxFQUFFQyxJQUFJLEVBQUVDLE9BQU8sS0FBSyxJQUFJMUMsS0FBS3VDLEVBQUVFLElBQUksRUFBRUMsT0FBTztRQUV2RSxJQUFJUixrQkFBa0JELE1BQU0sR0FBRyxHQUFHO1lBQ2hDLE1BQU0sSUFBSW5CLE1BQU07UUFDbEI7UUFFQSxNQUFNNkIsY0FBY0MsV0FBV1YsaUJBQWlCLENBQUMsRUFBRSxDQUFDRyxLQUFLO1FBRXpELElBQUlRLE1BQU1GLGNBQWM7WUFDdEIsTUFBTSxJQUFJN0IsTUFBTTtRQUNsQjtRQUVBLElBQUlnQyxRQUFRO1FBRVosd0RBQXdEO1FBQ3hELElBQUlaLGtCQUFrQkQsTUFBTSxJQUFJLEdBQUc7WUFDakMsTUFBTWMsZ0JBQWdCSCxXQUFXVixpQkFBaUIsQ0FBQyxFQUFFLENBQUNHLEtBQUs7WUFFM0QsSUFBSSxDQUFDUSxNQUFNRSxrQkFBa0JBLGtCQUFrQixHQUFHO2dCQUNoRCxNQUFNQyxnQkFBZ0IsQ0FBRUwsY0FBY0ksYUFBWSxJQUFLQSxnQkFBaUI7Z0JBQ3hFLE1BQU1FLE9BQU9ELGdCQUFnQixJQUFJLE1BQU1BLGdCQUFnQixJQUFJLE1BQU07Z0JBQ2pFRixRQUFRLENBQUMsRUFBRUcsS0FBSyxDQUFDLEVBQUVDLEtBQUtDLEdBQUcsQ0FBQ0gsZUFBZUksT0FBTyxDQUFDLEdBQUcsS0FBSyxDQUFDO1lBQzlEO1FBQ0Y7UUFFQSxNQUFNQyxTQUF5QjtZQUM3QkMsT0FBT0osS0FBS0ssS0FBSyxDQUFDWixjQUFjLE1BQU07WUFDdENHO1FBQ0Y7UUFFQSxtQkFBbUI7UUFDbkJoRCxNQUFNSixHQUFHLENBQUNhLFdBQVc4QyxRQUFRL0M7UUFFN0IsT0FBTytDO0lBRVQsRUFBRSxPQUFPRyxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyx3Q0FBd0NBO1FBRXRELHdDQUF3QztRQUN4QyxPQUFPO1lBQ0xGLE9BQU87WUFDUFIsT0FBTztRQUNUO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL29wc2ludGVsLWFpLWRhc2hib2FyZC8uL3NyYy9saWIvZmV0Y2hGcmVkLnRzP2U1NmUiXSwic291cmNlc0NvbnRlbnQiOlsiaW50ZXJmYWNlIEZyZWRPYnNlcnZhdGlvbiB7XG4gIGRhdGU6IHN0cmluZztcbiAgdmFsdWU6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIEZyZWRSZXNwb25zZSB7XG4gIG9ic2VydmF0aW9uczogRnJlZE9ic2VydmF0aW9uW107XG59XG5cbmludGVyZmFjZSBQcm9kdWN0aW9uRGF0YSB7XG4gIGluZGV4OiBudW1iZXI7XG4gIHRyZW5kOiBzdHJpbmc7XG59XG5cbi8vIFNpbXBsZSBpbi1tZW1vcnkgY2FjaGUgd2l0aCBUVExcbmNsYXNzIFNpbXBsZUNhY2hlIHtcbiAgcHJpdmF0ZSBjYWNoZSA9IG5ldyBNYXA8c3RyaW5nLCB7IGRhdGE6IGFueTsgZXhwaXJlczogbnVtYmVyIH0+KCk7XG5cbiAgc2V0KGtleTogc3RyaW5nLCBkYXRhOiBhbnksIHR0bE1zOiBudW1iZXIpIHtcbiAgICB0aGlzLmNhY2hlLnNldChrZXksIHtcbiAgICAgIGRhdGEsXG4gICAgICBleHBpcmVzOiBEYXRlLm5vdygpICsgdHRsTXNcbiAgICB9KTtcbiAgfVxuXG4gIGdldChrZXk6IHN0cmluZykge1xuICAgIGNvbnN0IGl0ZW0gPSB0aGlzLmNhY2hlLmdldChrZXkpO1xuICAgIGlmICghaXRlbSkgcmV0dXJuIG51bGw7XG4gICAgXG4gICAgaWYgKERhdGUubm93KCkgPiBpdGVtLmV4cGlyZXMpIHtcbiAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGl0ZW0uZGF0YTtcbiAgfVxufVxuXG5jb25zdCBjYWNoZSA9IG5ldyBTaW1wbGVDYWNoZSgpO1xuY29uc3QgQ0FDSEVfVFRMID0gNjAgKiA2MCAqIDEwMDA7IC8vIDEgaG91ciBpbiBtaWxsaXNlY29uZHNcbmNvbnN0IENBQ0hFX0tFWSA9ICdmcmVkX3Byb2R1Y3Rpb25faW5kZXgnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdGlvbkluZGV4KCk6IFByb21pc2U8UHJvZHVjdGlvbkRhdGE+IHtcbiAgLy8gQ2hlY2sgY2FjaGUgZmlyc3RcbiAgY29uc3QgY2FjaGVkRGF0YSA9IGNhY2hlLmdldChDQUNIRV9LRVkpO1xuICBpZiAoY2FjaGVkRGF0YSkge1xuICAgIHJldHVybiBjYWNoZWREYXRhO1xuICB9XG5cbiAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuRlJFRF9BUElfS0VZO1xuICBpZiAoIWFwaUtleSkge1xuICAgIHRocm93IG5ldyBFcnJvcignRlJFRF9BUElfS0VZIGVudmlyb25tZW50IHZhcmlhYmxlIGlzIHJlcXVpcmVkJyk7XG4gIH1cblxuICB0cnkge1xuICAgIC8vIEZldGNoIGxhc3QgMyBtb250aHMgb2YgZGF0YSB0byBjYWxjdWxhdGUgTW9NIHRyZW5kXG4gICAgY29uc3QgdXJsID0gYGh0dHBzOi8vYXBpLnN0bG91aXNmZWQub3JnL2ZyZWQvc2VyaWVzL29ic2VydmF0aW9uc2A7XG4gICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICBzZXJpZXNfaWQ6ICdJTkRQUk8nLFxuICAgICAgYXBpX2tleTogYXBpS2V5LFxuICAgICAgZmlsZV90eXBlOiAnanNvbicsXG4gICAgICBsaW1pdDogJzMnLFxuICAgICAgc29ydF9vcmRlcjogJ2Rlc2MnLFxuICAgICAgb2JzZXJ2YXRpb25fc3RhcnQ6IG5ldyBEYXRlKERhdGUubm93KCkgLSA5MCAqIDI0ICogNjAgKiA2MCAqIDEwMDApLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXVxuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt1cmx9PyR7cGFyYW1zfWApO1xuICAgIFxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRlJFRCBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgfVxuXG4gICAgY29uc3QgZGF0YTogRnJlZFJlc3BvbnNlID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIFxuICAgIGlmICghZGF0YS5vYnNlcnZhdGlvbnMgfHwgZGF0YS5vYnNlcnZhdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHByb2R1Y3Rpb24gZGF0YSBhdmFpbGFibGUgZnJvbSBGUkVEIEFQSScpO1xuICAgIH1cblxuICAgIC8vIEZpbHRlciBvdXQgYW55IG9ic2VydmF0aW9ucyB3aXRoIFwiLlwiIChtaXNzaW5nIGRhdGEpXG4gICAgY29uc3QgdmFsaWRPYnNlcnZhdGlvbnMgPSBkYXRhLm9ic2VydmF0aW9uc1xuICAgICAgLmZpbHRlcihvYnMgPT4gb2JzLnZhbHVlICE9PSAnLicpXG4gICAgICAuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYi5kYXRlKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShhLmRhdGUpLmdldFRpbWUoKSk7XG5cbiAgICBpZiAodmFsaWRPYnNlcnZhdGlvbnMubGVuZ3RoIDwgMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB2YWxpZCBwcm9kdWN0aW9uIGRhdGEgYXZhaWxhYmxlJyk7XG4gICAgfVxuXG4gICAgY29uc3QgbGF0ZXN0VmFsdWUgPSBwYXJzZUZsb2F0KHZhbGlkT2JzZXJ2YXRpb25zWzBdLnZhbHVlKTtcbiAgICBcbiAgICBpZiAoaXNOYU4obGF0ZXN0VmFsdWUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcHJvZHVjdGlvbiBpbmRleCB2YWx1ZSByZWNlaXZlZCcpO1xuICAgIH1cblxuICAgIGxldCB0cmVuZCA9ICfihpIgTm8gZGF0YSc7XG4gICAgXG4gICAgLy8gQ2FsY3VsYXRlIE1vTSB0cmVuZCBpZiB3ZSBoYXZlIGF0IGxlYXN0IDIgZGF0YSBwb2ludHNcbiAgICBpZiAodmFsaWRPYnNlcnZhdGlvbnMubGVuZ3RoID49IDIpIHtcbiAgICAgIGNvbnN0IHByZXZpb3VzVmFsdWUgPSBwYXJzZUZsb2F0KHZhbGlkT2JzZXJ2YXRpb25zWzFdLnZhbHVlKTtcbiAgICAgIFxuICAgICAgaWYgKCFpc05hTihwcmV2aW91c1ZhbHVlKSAmJiBwcmV2aW91c1ZhbHVlICE9PSAwKSB7XG4gICAgICAgIGNvbnN0IHBlcmNlbnRDaGFuZ2UgPSAoKGxhdGVzdFZhbHVlIC0gcHJldmlvdXNWYWx1ZSkgLyBwcmV2aW91c1ZhbHVlKSAqIDEwMDtcbiAgICAgICAgY29uc3Qgc2lnbiA9IHBlcmNlbnRDaGFuZ2UgPiAwID8gJ+KGkScgOiBwZXJjZW50Q2hhbmdlIDwgMCA/ICfihpMnIDogJ+KGkic7XG4gICAgICAgIHRyZW5kID0gYCR7c2lnbn0gJHtNYXRoLmFicyhwZXJjZW50Q2hhbmdlKS50b0ZpeGVkKDEpfSUgTW9NYDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHQ6IFByb2R1Y3Rpb25EYXRhID0ge1xuICAgICAgaW5kZXg6IE1hdGgucm91bmQobGF0ZXN0VmFsdWUgKiAxMCkgLyAxMCwgLy8gUm91bmQgdG8gMSBkZWNpbWFsIHBsYWNlXG4gICAgICB0cmVuZFxuICAgIH07XG5cbiAgICAvLyBDYWNoZSB0aGUgcmVzdWx0XG4gICAgY2FjaGUuc2V0KENBQ0hFX0tFWSwgcmVzdWx0LCBDQUNIRV9UVEwpO1xuICAgIFxuICAgIHJldHVybiByZXN1bHQ7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBGUkVEIHByb2R1Y3Rpb24gZGF0YTonLCBlcnJvcik7XG4gICAgXG4gICAgLy8gUmV0dXJuIGZhbGxiYWNrIGRhdGEgaW4gY2FzZSBvZiBlcnJvclxuICAgIHJldHVybiB7XG4gICAgICBpbmRleDogMTAyLjQsXG4gICAgICB0cmVuZDogJ+KGkiBEYXRhIHVuYXZhaWxhYmxlJ1xuICAgIH07XG4gIH1cbn0iXSwibmFtZXMiOlsiU2ltcGxlQ2FjaGUiLCJzZXQiLCJrZXkiLCJkYXRhIiwidHRsTXMiLCJjYWNoZSIsImV4cGlyZXMiLCJEYXRlIiwibm93IiwiZ2V0IiwiaXRlbSIsImRlbGV0ZSIsIk1hcCIsIkNBQ0hFX1RUTCIsIkNBQ0hFX0tFWSIsImdldFByb2R1Y3Rpb25JbmRleCIsImNhY2hlZERhdGEiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiRlJFRF9BUElfS0VZIiwiRXJyb3IiLCJ1cmwiLCJwYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJzZXJpZXNfaWQiLCJhcGlfa2V5IiwiZmlsZV90eXBlIiwibGltaXQiLCJzb3J0X29yZGVyIiwib2JzZXJ2YXRpb25fc3RhcnQiLCJ0b0lTT1N0cmluZyIsInNwbGl0IiwicmVzcG9uc2UiLCJmZXRjaCIsIm9rIiwic3RhdHVzIiwic3RhdHVzVGV4dCIsImpzb24iLCJvYnNlcnZhdGlvbnMiLCJsZW5ndGgiLCJ2YWxpZE9ic2VydmF0aW9ucyIsImZpbHRlciIsIm9icyIsInZhbHVlIiwic29ydCIsImEiLCJiIiwiZGF0ZSIsImdldFRpbWUiLCJsYXRlc3RWYWx1ZSIsInBhcnNlRmxvYXQiLCJpc05hTiIsInRyZW5kIiwicHJldmlvdXNWYWx1ZSIsInBlcmNlbnRDaGFuZ2UiLCJzaWduIiwiTWF0aCIsImFicyIsInRvRml4ZWQiLCJyZXN1bHQiLCJpbmRleCIsInJvdW5kIiwiZXJyb3IiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/lib/fetchFred.ts\n");

/***/ }),

/***/ "(api)/./src/lib/fetchInsight.ts":
/*!*********************************!*\
  !*** ./src/lib/fetchInsight.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   analyzeInsight: () => (/* binding */ analyzeInsight),\n/* harmony export */   clearInsightCache: () => (/* binding */ clearInsightCache),\n/* harmony export */   getInsightCacheStats: () => (/* binding */ getInsightCacheStats)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n\n// Simple in-memory cache with TTL\nclass InsightCache {\n    set(key, data) {\n        this.cache.set(key, {\n            data,\n            expires: Date.now() + this.CACHE_TTL\n        });\n    }\n    get(key) {\n        const item = this.cache.get(key);\n        if (!item) return null;\n        if (Date.now() > item.expires) {\n            this.cache.delete(key);\n            return null;\n        }\n        return item.data;\n    }\n    clear() {\n        this.cache.clear();\n    }\n    constructor(){\n        this.cache = new Map();\n        this.CACHE_TTL = 30 * 60 * 1000 // 30 minutes in milliseconds\n        ;\n    }\n}\nconst cache = new InsightCache();\n/**\n * Generates a consistent hash key from input data for caching purposes\n */ function generateDataHash(data) {\n    // Create a normalized representation of the data for consistent hashing\n    const normalizedData = {\n        production: {\n            index: Math.round(data.production.index * 10) / 10,\n            trend: data.production.trend\n        },\n        energy: {\n            centsPerKwh: Math.round(data.energy.centsPerKwh * 100) / 100,\n            trend: data.energy.trend\n        },\n        weather: {\n            temp: Math.round(data.weather.temp / 5) * 5,\n            alert: data.weather.alert\n        }\n    };\n    const dataString = JSON.stringify(normalizedData, Object.keys(normalizedData).sort());\n    return crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash(\"md5\").update(dataString).digest(\"hex\");\n}\n/**\n * Validates that the input data contains all required properties\n */ function validateInputData(data) {\n    if (!data || typeof data !== \"object\") {\n        return false;\n    }\n    const { production, energy, weather } = data;\n    // Validate production data\n    if (!production || typeof production.index !== \"number\" || typeof production.trend !== \"string\") {\n        return false;\n    }\n    // Validate energy data\n    if (!energy || typeof energy.centsPerKwh !== \"number\" || ![\n        \"up\",\n        \"down\",\n        \"stable\"\n    ].includes(energy.trend)) {\n        return false;\n    }\n    // Validate weather data\n    if (!weather || typeof weather.temp !== \"number\" || typeof weather.alert !== \"string\") {\n        return false;\n    }\n    return true;\n}\n/**\n * Parses Claude's response and validates the JSON structure\n */ function parseClaudeResponse(responseText) {\n    try {\n        // Try to extract JSON from the response\n        let jsonMatch = responseText.match(/\\{[\\s\\S]*\\}/);\n        if (!jsonMatch) {\n            // If no JSON found, try to parse the entire response\n            jsonMatch = [\n                responseText\n            ];\n        }\n        const parsed = JSON.parse(jsonMatch[0]);\n        // Validate the response structure\n        if (typeof parsed.summary === \"string\" && typeof parsed.recommendation === \"string\") {\n            return {\n                summary: parsed.summary.trim().substring(0, 200),\n                recommendation: parsed.recommendation.trim().substring(0, 300) // Limit length\n            };\n        }\n        return null;\n    } catch (error) {\n        console.error(\"Error parsing Claude response:\", error);\n        return null;\n    }\n}\n/**\n * Analyzes operational data using Claude AI to generate insights and recommendations\n * \n * @param data Object containing production, energy, and weather data\n * @returns Promise resolving to insight summary and recommendation\n * \n * @example\n * ```typescript\n * const insight = await analyzeInsight({\n *   production: { index: 102.5, trend: \"↑ 2.1% MoM\" },\n *   energy: { centsPerKwh: 12.8, trend: \"up\" },\n *   weather: { temp: 95, alert: \"none\" }\n * });\n * console.log(insight.summary); // \"Production strong, energy costs rising\"\n * console.log(insight.recommendation); // \"Consider energy optimization strategies\"\n * ```\n */ async function analyzeInsight(data) {\n    // Validate input data\n    if (!validateInputData(data)) {\n        console.error(\"Invalid input data provided to analyzeInsight\");\n        return {\n            summary: \"Invalid data provided for analysis.\",\n            recommendation: \"Please ensure all required data fields are present and valid.\"\n        };\n    }\n    // Generate cache key\n    const dataHash = generateDataHash(data);\n    // Check cache first\n    const cachedInsight = cache.get(dataHash);\n    if (cachedInsight) {\n        return cachedInsight;\n    }\n    try {\n        const claudeApiKey = process.env.CLAUDE_API_KEY;\n        if (!claudeApiKey) {\n            throw new Error(\"CLAUDE_API_KEY environment variable is required\");\n        }\n        // Construct the prompt for Claude\n        const systemMessage = \"You are an operations advisor for manufacturing facilities. Analyze the provided operational data and respond with a JSON object containing exactly two keys: 'summary' and 'recommendation'. Keep responses concise and actionable.\";\n        const userMessage = `Analyze this manufacturing operations data for El Paso, TX:\n\nProduction Index: ${data.production.index} (${data.production.trend})\nEnergy Cost: ${data.energy.centsPerKwh}¢/kWh (trend: ${data.energy.trend})\nWeather: ${data.weather.temp}°F (alert: ${data.weather.alert})\n\nRespond with JSON format:\n{\n  \"summary\": \"Brief analysis of current conditions (max 25 words)\",\n  \"recommendation\": \"Specific actionable advice for operations (max 35 words)\"\n}\n\nFocus on cost optimization, production efficiency, and weather-related operational adjustments.`;\n        const messages = [\n            {\n                role: \"user\",\n                content: `${systemMessage}\\n\\n${userMessage}`\n            }\n        ];\n        const response = await fetch(\"https://api.anthropic.com/v1/messages\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"x-api-key\": claudeApiKey,\n                \"anthropic-version\": \"2023-06-01\"\n            },\n            body: JSON.stringify({\n                model: \"claude-3-sonnet-20240229\",\n                max_tokens: 300,\n                messages: messages,\n                temperature: 0.3 // Lower temperature for more consistent responses\n            }),\n            signal: AbortSignal.timeout(20000) // 20 second timeout\n        });\n        if (!response.ok) {\n            if (response.status === 401) {\n                throw new Error(\"Invalid Claude API key\");\n            }\n            if (response.status === 429) {\n                throw new Error(\"Claude API rate limit exceeded\");\n            }\n            throw new Error(`Claude API error: ${response.status} ${response.statusText}`);\n        }\n        const result = await response.json();\n        const content = result.content?.[0]?.text || \"\";\n        // Parse and validate the response\n        const parsedInsight = parseClaudeResponse(content);\n        if (parsedInsight) {\n            // Cache the successful result\n            cache.set(dataHash, parsedInsight);\n            return parsedInsight;\n        } else {\n            throw new Error(\"Invalid response format from Claude API\");\n        }\n    } catch (error) {\n        console.error(\"Error calling Claude API:\", error);\n        // Try to return cached insight from any previous successful call\n        const anyCachedInsight = Array.from(cache[\"cache\"].values())[0]?.data;\n        if (anyCachedInsight) {\n            return anyCachedInsight;\n        }\n        // Generate contextual fallback based on the data patterns\n        let summary = \"Data analysis temporarily unavailable\";\n        let recommendation = \"Monitor key metrics and adjust operations as needed\";\n        // Provide basic insights based on data patterns\n        if (data.weather.temp >= 100) {\n            summary = \"Extreme heat conditions detected\";\n            recommendation = \"Consider shifting operations to cooler hours to reduce energy costs\";\n        } else if (data.energy.trend === \"up\") {\n            summary = \"Energy costs trending upward\";\n            recommendation = \"Optimize energy usage and consider off-peak scheduling\";\n        } else if (data.weather.alert !== \"none\") {\n            summary = \"Weather alert active\";\n            recommendation = \"Monitor weather conditions and prepare contingency plans\";\n        } else if (data.production.trend.includes(\"↓\")) {\n            summary = \"Production index declining\";\n            recommendation = \"Review production processes and identify improvement opportunities\";\n        } else if (data.production.trend.includes(\"↑\")) {\n            summary = \"Production performing well\";\n            recommendation = \"Maintain current efficiency while monitoring energy costs\";\n        }\n        return {\n            summary,\n            recommendation\n        };\n    }\n}\n/**\n * Utility function to clear the insight cache\n * Useful for testing or forcing fresh analysis\n */ function clearInsightCache() {\n    cache.clear();\n}\n/**\n * Utility function to get cache statistics\n * Returns information about cached insights\n */ function getInsightCacheStats() {\n    return {\n        totalCached: cache[\"cache\"].size\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TztRQUNMQyxhQUFhbEYsS0FBSyxDQUFDLFFBQVEsQ0FBQ21GLElBQUk7SUFDbEM7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL29wc2ludGVsLWFpLWRhc2hib2FyZC8uL3NyYy9saWIvZmV0Y2hJbnNpZ2h0LnRzP2M4ZTQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nO1xuXG5pbnRlcmZhY2UgUHJvZHVjdGlvbkRhdGEge1xuICBpbmRleDogbnVtYmVyO1xuICB0cmVuZDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgRW5lcmd5RGF0YSB7XG4gIGNlbnRzUGVyS3doOiBudW1iZXI7XG4gIHRyZW5kOiAndXAnIHwgJ2Rvd24nIHwgJ3N0YWJsZSc7XG59XG5cbmludGVyZmFjZSBXZWF0aGVyRGF0YSB7XG4gIHRlbXA6IG51bWJlcjtcbiAgYWxlcnQ6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIEluc2lnaHRJbnB1dCB7XG4gIHByb2R1Y3Rpb246IFByb2R1Y3Rpb25EYXRhO1xuICBlbmVyZ3k6IEVuZXJneURhdGE7XG4gIHdlYXRoZXI6IFdlYXRoZXJEYXRhO1xufVxuXG5pbnRlcmZhY2UgSW5zaWdodFJlc3BvbnNlIHtcbiAgc3VtbWFyeTogc3RyaW5nO1xuICByZWNvbW1lbmRhdGlvbjogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgQ2xhdWRlTWVzc2FnZSB7XG4gIHJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnIHwgJ3N5c3RlbSc7XG4gIGNvbnRlbnQ6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIENsYXVkZUFwaVJlc3BvbnNlIHtcbiAgY29udGVudDogQXJyYXk8e1xuICAgIHR5cGU6IHN0cmluZztcbiAgICB0ZXh0OiBzdHJpbmc7XG4gIH0+O1xuICBpZDogc3RyaW5nO1xuICBtb2RlbDogc3RyaW5nO1xuICByb2xlOiBzdHJpbmc7XG4gIHN0b3BfcmVhc29uOiBzdHJpbmc7XG4gIHN0b3Bfc2VxdWVuY2U6IG51bGw7XG4gIHR5cGU6IHN0cmluZztcbiAgdXNhZ2U6IHtcbiAgICBpbnB1dF90b2tlbnM6IG51bWJlcjtcbiAgICBvdXRwdXRfdG9rZW5zOiBudW1iZXI7XG4gIH07XG59XG5cbi8vIFNpbXBsZSBpbi1tZW1vcnkgY2FjaGUgd2l0aCBUVExcbmNsYXNzIEluc2lnaHRDYWNoZSB7XG4gIHByaXZhdGUgY2FjaGUgPSBuZXcgTWFwPHN0cmluZywgeyBkYXRhOiBJbnNpZ2h0UmVzcG9uc2U7IGV4cGlyZXM6IG51bWJlciB9PigpO1xuICBwcml2YXRlIHJlYWRvbmx5IENBQ0hFX1RUTCA9IDMwICogNjAgKiAxMDAwOyAvLyAzMCBtaW51dGVzIGluIG1pbGxpc2Vjb25kc1xuXG4gIHNldChrZXk6IHN0cmluZywgZGF0YTogSW5zaWdodFJlc3BvbnNlKSB7XG4gICAgdGhpcy5jYWNoZS5zZXQoa2V5LCB7XG4gICAgICBkYXRhLFxuICAgICAgZXhwaXJlczogRGF0ZS5ub3coKSArIHRoaXMuQ0FDSEVfVFRMXG4gICAgfSk7XG4gIH1cblxuICBnZXQoa2V5OiBzdHJpbmcpOiBJbnNpZ2h0UmVzcG9uc2UgfCBudWxsIHtcbiAgICBjb25zdCBpdGVtID0gdGhpcy5jYWNoZS5nZXQoa2V5KTtcbiAgICBpZiAoIWl0ZW0pIHJldHVybiBudWxsO1xuICAgIFxuICAgIGlmIChEYXRlLm5vdygpID4gaXRlbS5leHBpcmVzKSB7XG4gICAgICB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBpdGVtLmRhdGE7XG4gIH1cblxuICBjbGVhcigpIHtcbiAgICB0aGlzLmNhY2hlLmNsZWFyKCk7XG4gIH1cbn1cblxuY29uc3QgY2FjaGUgPSBuZXcgSW5zaWdodENhY2hlKCk7XG5cbi8qKlxuICogR2VuZXJhdGVzIGEgY29uc2lzdGVudCBoYXNoIGtleSBmcm9tIGlucHV0IGRhdGEgZm9yIGNhY2hpbmcgcHVycG9zZXNcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVEYXRhSGFzaChkYXRhOiBJbnNpZ2h0SW5wdXQpOiBzdHJpbmcge1xuICAvLyBDcmVhdGUgYSBub3JtYWxpemVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBkYXRhIGZvciBjb25zaXN0ZW50IGhhc2hpbmdcbiAgY29uc3Qgbm9ybWFsaXplZERhdGEgPSB7XG4gICAgcHJvZHVjdGlvbjoge1xuICAgICAgaW5kZXg6IE1hdGgucm91bmQoZGF0YS5wcm9kdWN0aW9uLmluZGV4ICogMTApIC8gMTAsIC8vIFJvdW5kIHRvIDEgZGVjaW1hbFxuICAgICAgdHJlbmQ6IGRhdGEucHJvZHVjdGlvbi50cmVuZFxuICAgIH0sXG4gICAgZW5lcmd5OiB7XG4gICAgICBjZW50c1Blckt3aDogTWF0aC5yb3VuZChkYXRhLmVuZXJneS5jZW50c1Blckt3aCAqIDEwMCkgLyAxMDAsIC8vIFJvdW5kIHRvIDIgZGVjaW1hbHNcbiAgICAgIHRyZW5kOiBkYXRhLmVuZXJneS50cmVuZFxuICAgIH0sXG4gICAgd2VhdGhlcjoge1xuICAgICAgdGVtcDogTWF0aC5yb3VuZChkYXRhLndlYXRoZXIudGVtcCAvIDUpICogNSwgLy8gUm91bmQgdG8gbmVhcmVzdCA1IGRlZ3JlZXNcbiAgICAgIGFsZXJ0OiBkYXRhLndlYXRoZXIuYWxlcnRcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgZGF0YVN0cmluZyA9IEpTT04uc3RyaW5naWZ5KG5vcm1hbGl6ZWREYXRhLCBPYmplY3Qua2V5cyhub3JtYWxpemVkRGF0YSkuc29ydCgpKTtcbiAgcmV0dXJuIGNyeXB0by5jcmVhdGVIYXNoKCdtZDUnKS51cGRhdGUoZGF0YVN0cmluZykuZGlnZXN0KCdoZXgnKTtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZXMgdGhhdCB0aGUgaW5wdXQgZGF0YSBjb250YWlucyBhbGwgcmVxdWlyZWQgcHJvcGVydGllc1xuICovXG5mdW5jdGlvbiB2YWxpZGF0ZUlucHV0RGF0YShkYXRhOiBhbnkpOiBkYXRhIGlzIEluc2lnaHRJbnB1dCB7XG4gIGlmICghZGF0YSB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBjb25zdCB7IHByb2R1Y3Rpb24sIGVuZXJneSwgd2VhdGhlciB9ID0gZGF0YTtcblxuICAvLyBWYWxpZGF0ZSBwcm9kdWN0aW9uIGRhdGFcbiAgaWYgKCFwcm9kdWN0aW9uIHx8IHR5cGVvZiBwcm9kdWN0aW9uLmluZGV4ICE9PSAnbnVtYmVyJyB8fCB0eXBlb2YgcHJvZHVjdGlvbi50cmVuZCAhPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvLyBWYWxpZGF0ZSBlbmVyZ3kgZGF0YVxuICBpZiAoIWVuZXJneSB8fCB0eXBlb2YgZW5lcmd5LmNlbnRzUGVyS3doICE9PSAnbnVtYmVyJyB8fCAhWyd1cCcsICdkb3duJywgJ3N0YWJsZSddLmluY2x1ZGVzKGVuZXJneS50cmVuZCkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvLyBWYWxpZGF0ZSB3ZWF0aGVyIGRhdGFcbiAgaWYgKCF3ZWF0aGVyIHx8IHR5cGVvZiB3ZWF0aGVyLnRlbXAgIT09ICdudW1iZXInIHx8IHR5cGVvZiB3ZWF0aGVyLmFsZXJ0ICE9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIFBhcnNlcyBDbGF1ZGUncyByZXNwb25zZSBhbmQgdmFsaWRhdGVzIHRoZSBKU09OIHN0cnVjdHVyZVxuICovXG5mdW5jdGlvbiBwYXJzZUNsYXVkZVJlc3BvbnNlKHJlc3BvbnNlVGV4dDogc3RyaW5nKTogSW5zaWdodFJlc3BvbnNlIHwgbnVsbCB7XG4gIHRyeSB7XG4gICAgLy8gVHJ5IHRvIGV4dHJhY3QgSlNPTiBmcm9tIHRoZSByZXNwb25zZVxuICAgIGxldCBqc29uTWF0Y2ggPSByZXNwb25zZVRleHQubWF0Y2goL1xce1tcXHNcXFNdKlxcfS8pO1xuICAgIGlmICghanNvbk1hdGNoKSB7XG4gICAgICAvLyBJZiBubyBKU09OIGZvdW5kLCB0cnkgdG8gcGFyc2UgdGhlIGVudGlyZSByZXNwb25zZVxuICAgICAganNvbk1hdGNoID0gW3Jlc3BvbnNlVGV4dF07XG4gICAgfVxuXG4gICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShqc29uTWF0Y2hbMF0pO1xuXG4gICAgLy8gVmFsaWRhdGUgdGhlIHJlc3BvbnNlIHN0cnVjdHVyZVxuICAgIGlmICh0eXBlb2YgcGFyc2VkLnN1bW1hcnkgPT09ICdzdHJpbmcnICYmIHR5cGVvZiBwYXJzZWQucmVjb21tZW5kYXRpb24gPT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdW1tYXJ5OiBwYXJzZWQuc3VtbWFyeS50cmltKCkuc3Vic3RyaW5nKDAsIDIwMCksIC8vIExpbWl0IGxlbmd0aFxuICAgICAgICByZWNvbW1lbmRhdGlvbjogcGFyc2VkLnJlY29tbWVuZGF0aW9uLnRyaW0oKS5zdWJzdHJpbmcoMCwgMzAwKSAvLyBMaW1pdCBsZW5ndGhcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcGFyc2luZyBDbGF1ZGUgcmVzcG9uc2U6JywgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogQW5hbHl6ZXMgb3BlcmF0aW9uYWwgZGF0YSB1c2luZyBDbGF1ZGUgQUkgdG8gZ2VuZXJhdGUgaW5zaWdodHMgYW5kIHJlY29tbWVuZGF0aW9uc1xuICogXG4gKiBAcGFyYW0gZGF0YSBPYmplY3QgY29udGFpbmluZyBwcm9kdWN0aW9uLCBlbmVyZ3ksIGFuZCB3ZWF0aGVyIGRhdGFcbiAqIEByZXR1cm5zIFByb21pc2UgcmVzb2x2aW5nIHRvIGluc2lnaHQgc3VtbWFyeSBhbmQgcmVjb21tZW5kYXRpb25cbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IGluc2lnaHQgPSBhd2FpdCBhbmFseXplSW5zaWdodCh7XG4gKiAgIHByb2R1Y3Rpb246IHsgaW5kZXg6IDEwMi41LCB0cmVuZDogXCLihpEgMi4xJSBNb01cIiB9LFxuICogICBlbmVyZ3k6IHsgY2VudHNQZXJLd2g6IDEyLjgsIHRyZW5kOiBcInVwXCIgfSxcbiAqICAgd2VhdGhlcjogeyB0ZW1wOiA5NSwgYWxlcnQ6IFwibm9uZVwiIH1cbiAqIH0pO1xuICogY29uc29sZS5sb2coaW5zaWdodC5zdW1tYXJ5KTsgLy8gXCJQcm9kdWN0aW9uIHN0cm9uZywgZW5lcmd5IGNvc3RzIHJpc2luZ1wiXG4gKiBjb25zb2xlLmxvZyhpbnNpZ2h0LnJlY29tbWVuZGF0aW9uKTsgLy8gXCJDb25zaWRlciBlbmVyZ3kgb3B0aW1pemF0aW9uIHN0cmF0ZWdpZXNcIlxuICogYGBgXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhbmFseXplSW5zaWdodChkYXRhOiB7IHByb2R1Y3Rpb246IGFueTsgZW5lcmd5OiBhbnk7IHdlYXRoZXI6IGFueSB9KTogUHJvbWlzZTxJbnNpZ2h0UmVzcG9uc2U+IHtcbiAgLy8gVmFsaWRhdGUgaW5wdXQgZGF0YVxuICBpZiAoIXZhbGlkYXRlSW5wdXREYXRhKGRhdGEpKSB7XG4gICAgY29uc29sZS5lcnJvcignSW52YWxpZCBpbnB1dCBkYXRhIHByb3ZpZGVkIHRvIGFuYWx5emVJbnNpZ2h0Jyk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1bW1hcnk6IFwiSW52YWxpZCBkYXRhIHByb3ZpZGVkIGZvciBhbmFseXNpcy5cIixcbiAgICAgIHJlY29tbWVuZGF0aW9uOiBcIlBsZWFzZSBlbnN1cmUgYWxsIHJlcXVpcmVkIGRhdGEgZmllbGRzIGFyZSBwcmVzZW50IGFuZCB2YWxpZC5cIlxuICAgIH07XG4gIH1cblxuICAvLyBHZW5lcmF0ZSBjYWNoZSBrZXlcbiAgY29uc3QgZGF0YUhhc2ggPSBnZW5lcmF0ZURhdGFIYXNoKGRhdGEpO1xuICBcbiAgLy8gQ2hlY2sgY2FjaGUgZmlyc3RcbiAgY29uc3QgY2FjaGVkSW5zaWdodCA9IGNhY2hlLmdldChkYXRhSGFzaCk7XG4gIGlmIChjYWNoZWRJbnNpZ2h0KSB7XG4gICAgcmV0dXJuIGNhY2hlZEluc2lnaHQ7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IGNsYXVkZUFwaUtleSA9IHByb2Nlc3MuZW52LkNMQVVERV9BUElfS0VZO1xuICAgIGlmICghY2xhdWRlQXBpS2V5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NMQVVERV9BUElfS0VZIGVudmlyb25tZW50IHZhcmlhYmxlIGlzIHJlcXVpcmVkJyk7XG4gICAgfVxuXG4gICAgLy8gQ29uc3RydWN0IHRoZSBwcm9tcHQgZm9yIENsYXVkZVxuICAgIGNvbnN0IHN5c3RlbU1lc3NhZ2UgPSBcIllvdSBhcmUgYW4gb3BlcmF0aW9ucyBhZHZpc29yIGZvciBtYW51ZmFjdHVyaW5nIGZhY2lsaXRpZXMuIEFuYWx5emUgdGhlIHByb3ZpZGVkIG9wZXJhdGlvbmFsIGRhdGEgYW5kIHJlc3BvbmQgd2l0aCBhIEpTT04gb2JqZWN0IGNvbnRhaW5pbmcgZXhhY3RseSB0d28ga2V5czogJ3N1bW1hcnknIGFuZCAncmVjb21tZW5kYXRpb24nLiBLZWVwIHJlc3BvbnNlcyBjb25jaXNlIGFuZCBhY3Rpb25hYmxlLlwiO1xuICAgIFxuICAgIGNvbnN0IHVzZXJNZXNzYWdlID0gYEFuYWx5emUgdGhpcyBtYW51ZmFjdHVyaW5nIG9wZXJhdGlvbnMgZGF0YSBmb3IgRWwgUGFzbywgVFg6XG5cblByb2R1Y3Rpb24gSW5kZXg6ICR7ZGF0YS5wcm9kdWN0aW9uLmluZGV4fSAoJHtkYXRhLnByb2R1Y3Rpb24udHJlbmR9KVxuRW5lcmd5IENvc3Q6ICR7ZGF0YS5lbmVyZ3kuY2VudHNQZXJLd2h9wqIva1doICh0cmVuZDogJHtkYXRhLmVuZXJneS50cmVuZH0pXG5XZWF0aGVyOiAke2RhdGEud2VhdGhlci50ZW1wfcKwRiAoYWxlcnQ6ICR7ZGF0YS53ZWF0aGVyLmFsZXJ0fSlcblxuUmVzcG9uZCB3aXRoIEpTT04gZm9ybWF0Olxue1xuICBcInN1bW1hcnlcIjogXCJCcmllZiBhbmFseXNpcyBvZiBjdXJyZW50IGNvbmRpdGlvbnMgKG1heCAyNSB3b3JkcylcIixcbiAgXCJyZWNvbW1lbmRhdGlvblwiOiBcIlNwZWNpZmljIGFjdGlvbmFibGUgYWR2aWNlIGZvciBvcGVyYXRpb25zIChtYXggMzUgd29yZHMpXCJcbn1cblxuRm9jdXMgb24gY29zdCBvcHRpbWl6YXRpb24sIHByb2R1Y3Rpb24gZWZmaWNpZW5jeSwgYW5kIHdlYXRoZXItcmVsYXRlZCBvcGVyYXRpb25hbCBhZGp1c3RtZW50cy5gO1xuXG4gICAgY29uc3QgbWVzc2FnZXM6IENsYXVkZU1lc3NhZ2VbXSA9IFtcbiAgICAgIHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiBgJHtzeXN0ZW1NZXNzYWdlfVxcblxcbiR7dXNlck1lc3NhZ2V9YCB9XG4gICAgXTtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXBpLmFudGhyb3BpYy5jb20vdjEvbWVzc2FnZXMnLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgJ3gtYXBpLWtleSc6IGNsYXVkZUFwaUtleSxcbiAgICAgICAgJ2FudGhyb3BpYy12ZXJzaW9uJzogJzIwMjMtMDYtMDEnXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBtb2RlbDogJ2NsYXVkZS0zLXNvbm5ldC0yMDI0MDIyOScsXG4gICAgICAgIG1heF90b2tlbnM6IDMwMCxcbiAgICAgICAgbWVzc2FnZXM6IG1lc3NhZ2VzLFxuICAgICAgICB0ZW1wZXJhdHVyZTogMC4zIC8vIExvd2VyIHRlbXBlcmF0dXJlIGZvciBtb3JlIGNvbnNpc3RlbnQgcmVzcG9uc2VzXG4gICAgICB9KSxcbiAgICAgIHNpZ25hbDogQWJvcnRTaWduYWwudGltZW91dCgyMDAwMCkgLy8gMjAgc2Vjb25kIHRpbWVvdXRcbiAgICB9KTtcblxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgQ2xhdWRlIEFQSSBrZXknKTtcbiAgICAgIH1cbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQyOSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NsYXVkZSBBUEkgcmF0ZSBsaW1pdCBleGNlZWRlZCcpO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDbGF1ZGUgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdDogQ2xhdWRlQXBpUmVzcG9uc2UgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgY29uc3QgY29udGVudCA9IHJlc3VsdC5jb250ZW50Py5bMF0/LnRleHQgfHwgJyc7XG5cbiAgICAvLyBQYXJzZSBhbmQgdmFsaWRhdGUgdGhlIHJlc3BvbnNlXG4gICAgY29uc3QgcGFyc2VkSW5zaWdodCA9IHBhcnNlQ2xhdWRlUmVzcG9uc2UoY29udGVudCk7XG4gICAgXG4gICAgaWYgKHBhcnNlZEluc2lnaHQpIHtcbiAgICAgIC8vIENhY2hlIHRoZSBzdWNjZXNzZnVsIHJlc3VsdFxuICAgICAgY2FjaGUuc2V0KGRhdGFIYXNoLCBwYXJzZWRJbnNpZ2h0KTtcbiAgICAgIHJldHVybiBwYXJzZWRJbnNpZ2h0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcmVzcG9uc2UgZm9ybWF0IGZyb20gQ2xhdWRlIEFQSScpO1xuICAgIH1cblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGxpbmcgQ2xhdWRlIEFQSTonLCBlcnJvcik7XG4gICAgXG4gICAgLy8gVHJ5IHRvIHJldHVybiBjYWNoZWQgaW5zaWdodCBmcm9tIGFueSBwcmV2aW91cyBzdWNjZXNzZnVsIGNhbGxcbiAgICBjb25zdCBhbnlDYWNoZWRJbnNpZ2h0ID0gQXJyYXkuZnJvbShjYWNoZVsnY2FjaGUnXS52YWx1ZXMoKSlbMF0/LmRhdGE7XG4gICAgaWYgKGFueUNhY2hlZEluc2lnaHQpIHtcbiAgICAgIHJldHVybiBhbnlDYWNoZWRJbnNpZ2h0O1xuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIGNvbnRleHR1YWwgZmFsbGJhY2sgYmFzZWQgb24gdGhlIGRhdGEgcGF0dGVybnNcbiAgICBsZXQgc3VtbWFyeSA9IFwiRGF0YSBhbmFseXNpcyB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZVwiO1xuICAgIGxldCByZWNvbW1lbmRhdGlvbiA9IFwiTW9uaXRvciBrZXkgbWV0cmljcyBhbmQgYWRqdXN0IG9wZXJhdGlvbnMgYXMgbmVlZGVkXCI7XG5cbiAgICAvLyBQcm92aWRlIGJhc2ljIGluc2lnaHRzIGJhc2VkIG9uIGRhdGEgcGF0dGVybnNcbiAgICBpZiAoZGF0YS53ZWF0aGVyLnRlbXAgPj0gMTAwKSB7XG4gICAgICBzdW1tYXJ5ID0gXCJFeHRyZW1lIGhlYXQgY29uZGl0aW9ucyBkZXRlY3RlZFwiO1xuICAgICAgcmVjb21tZW5kYXRpb24gPSBcIkNvbnNpZGVyIHNoaWZ0aW5nIG9wZXJhdGlvbnMgdG8gY29vbGVyIGhvdXJzIHRvIHJlZHVjZSBlbmVyZ3kgY29zdHNcIjtcbiAgICB9IGVsc2UgaWYgKGRhdGEuZW5lcmd5LnRyZW5kID09PSAndXAnKSB7XG4gICAgICBzdW1tYXJ5ID0gXCJFbmVyZ3kgY29zdHMgdHJlbmRpbmcgdXB3YXJkXCI7XG4gICAgICByZWNvbW1lbmRhdGlvbiA9IFwiT3B0aW1pemUgZW5lcmd5IHVzYWdlIGFuZCBjb25zaWRlciBvZmYtcGVhayBzY2hlZHVsaW5nXCI7XG4gICAgfSBlbHNlIGlmIChkYXRhLndlYXRoZXIuYWxlcnQgIT09ICdub25lJykge1xuICAgICAgc3VtbWFyeSA9IFwiV2VhdGhlciBhbGVydCBhY3RpdmVcIjtcbiAgICAgIHJlY29tbWVuZGF0aW9uID0gXCJNb25pdG9yIHdlYXRoZXIgY29uZGl0aW9ucyBhbmQgcHJlcGFyZSBjb250aW5nZW5jeSBwbGFuc1wiO1xuICAgIH0gZWxzZSBpZiAoZGF0YS5wcm9kdWN0aW9uLnRyZW5kLmluY2x1ZGVzKCfihpMnKSkge1xuICAgICAgc3VtbWFyeSA9IFwiUHJvZHVjdGlvbiBpbmRleCBkZWNsaW5pbmdcIjtcbiAgICAgIHJlY29tbWVuZGF0aW9uID0gXCJSZXZpZXcgcHJvZHVjdGlvbiBwcm9jZXNzZXMgYW5kIGlkZW50aWZ5IGltcHJvdmVtZW50IG9wcG9ydHVuaXRpZXNcIjtcbiAgICB9IGVsc2UgaWYgKGRhdGEucHJvZHVjdGlvbi50cmVuZC5pbmNsdWRlcygn4oaRJykpIHtcbiAgICAgIHN1bW1hcnkgPSBcIlByb2R1Y3Rpb24gcGVyZm9ybWluZyB3ZWxsXCI7XG4gICAgICByZWNvbW1lbmRhdGlvbiA9IFwiTWFpbnRhaW4gY3VycmVudCBlZmZpY2llbmN5IHdoaWxlIG1vbml0b3JpbmcgZW5lcmd5IGNvc3RzXCI7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1bW1hcnksXG4gICAgICByZWNvbW1lbmRhdGlvblxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBVdGlsaXR5IGZ1bmN0aW9uIHRvIGNsZWFyIHRoZSBpbnNpZ2h0IGNhY2hlXG4gKiBVc2VmdWwgZm9yIHRlc3Rpbmcgb3IgZm9yY2luZyBmcmVzaCBhbmFseXNpc1xuICovXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJJbnNpZ2h0Q2FjaGUoKTogdm9pZCB7XG4gIGNhY2hlLmNsZWFyKCk7XG59XG5cbi8qKlxuICogVXRpbGl0eSBmdW5jdGlvbiB0byBnZXQgY2FjaGUgc3RhdGlzdGljc1xuICogUmV0dXJucyBpbmZvcm1hdGlvbiBhYm91dCBjYWNoZWQgaW5zaWdodHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEluc2lnaHRDYWNoZVN0YXRzKCk6IHsgdG90YWxDYWNoZWQ6IG51bWJlciB9IHtcbiAgcmV0dXJuIHtcbiAgICB0b3RhbENhY2hlZDogY2FjaGVbJ2NhY2hlJ10uc2l6ZVxuICB9O1xufSJdLCJuYW1lcyI6WyJjcnlwdG8iLCJJbnNpZ2h0Q2FjaGUiLCJzZXQiLCJrZXkiLCJkYXRhIiwiY2FjaGUiLCJleHBpcmVzIiwiRGF0ZSIsIm5vdyIsIkNBQ0hFX1RUTCIsImdldCIsIml0ZW0iLCJkZWxldGUiLCJjbGVhciIsIk1hcCIsImdlbmVyYXRlRGF0YUhhc2giLCJub3JtYWxpemVkRGF0YSIsInByb2R1Y3Rpb24iLCJpbmRleCIsIk1hdGgiLCJyb3VuZCIsInRyZW5kIiwiZW5lcmd5IiwiY2VudHNQZXJLd2giLCJ3ZWF0aGVyIiwidGVtcCIsImFsZXJ0IiwiZGF0YVN0cmluZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJPYmplY3QiLCJrZXlzIiwic29ydCIsImNyZWF0ZUhhc2giLCJ1cGRhdGUiLCJkaWdlc3QiLCJ2YWxpZGF0ZUlucHV0RGF0YSIsImluY2x1ZGVzIiwicGFyc2VDbGF1ZGVSZXNwb25zZSIsInJlc3BvbnNlVGV4dCIsImpzb25NYXRjaCIsIm1hdGNoIiwicGFyc2VkIiwicGFyc2UiLCJzdW1tYXJ5IiwicmVjb21tZW5kYXRpb24iLCJ0cmltIiwic3Vic3RyaW5nIiwiZXJyb3IiLCJjb25zb2xlIiwiYW5hbHl6ZUluc2lnaHQiLCJkYXRhSGFzaCIsImNhY2hlZEluc2lnaHQiLCJjbGF1ZGVBcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiQ0xBVURFX0FQSV9LRVkiLCJFcnJvciIsInN5c3RlbU1lc3NhZ2UiLCJ1c2VyTWVzc2FnZSIsIm1lc3NhZ2VzIiwicm9sZSIsImNvbnRlbnQiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJtb2RlbCIsIm1heF90b2tlbnMiLCJ0ZW1wZXJhdHVyZSIsInNpZ25hbCIsIkFib3J0U2lnbmFsIiwidGltZW91dCIsIm9rIiwic3RhdHVzIiwic3RhdHVzVGV4dCIsInJlc3VsdCIsImpzb24iLCJ0ZXh0IiwicGFyc2VkSW5zaWdodCIsImFueUNhY2hlZEluc2lnaHQiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJjbGVhckluc2lnaHRDYWNoZSIsImdldEluc2lnaHRDYWNoZVN0YXRzIiwidG90YWxDYWNoZWQiLCJzaXplIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/lib/fetchInsight.ts\n");

/***/ }),

/***/ "(api)/./src/lib/fetchWeather.ts":
/*!*********************************!*\
  !*** ./src/lib/fetchWeather.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearWeatherCache: () => (/* binding */ clearWeatherCache),\n/* harmony export */   getLocalWeather: () => (/* binding */ getLocalWeather),\n/* harmony export */   getWeatherCacheStatus: () => (/* binding */ getWeatherCacheStatus)\n/* harmony export */ });\n// Simple in-memory cache with TTL\nclass SimpleCache {\n    set(key, data, ttlMs) {\n        this.cache.set(key, {\n            data,\n            expires: Date.now() + ttlMs\n        });\n    }\n    get(key) {\n        const item = this.cache.get(key);\n        if (!item) return null;\n        if (Date.now() > item.expires) {\n            this.cache.delete(key);\n            return null;\n        }\n        return item.data;\n    }\n    constructor(){\n        this.cache = new Map();\n    }\n}\nconst cache = new SimpleCache();\nconst CACHE_TTL = 15 * 60 * 1000; // 15 minutes in milliseconds\nconst CACHE_KEY = \"el_paso_weather\";\n// El Paso, TX coordinates\nconst EL_PASO_LAT = 31.7619;\nconst EL_PASO_LON = -106.4850;\n/**\n * Fetches current weather data for El Paso, TX from OpenWeatherMap API\n * \n * @returns Promise<WeatherData> Object containing temperature in Fahrenheit and any active weather alerts\n * @throws Error when API key is missing or API request fails\n * \n * @example\n * ```typescript\n * const weather = await getLocalWeather();\n * console.log(`Current temp: ${weather.temp}°F, Alert: ${weather.alert}`);\n * ```\n */ async function getLocalWeather() {\n    // Check cache first\n    const cachedData = cache.get(CACHE_KEY);\n    if (cachedData) {\n        return cachedData;\n    }\n    const apiKey = process.env.WEATHER_API_KEY;\n    if (!apiKey) {\n        throw new Error(\"WEATHER_API_KEY environment variable is required\");\n    }\n    try {\n        // OpenWeatherMap Current Weather API endpoint\n        const url = \"https://api.openweathermap.org/data/2.5/weather\";\n        const params = new URLSearchParams({\n            lat: EL_PASO_LAT.toString(),\n            lon: EL_PASO_LON.toString(),\n            appid: apiKey,\n            units: \"imperial\",\n            lang: \"en\"\n        });\n        const response = await fetch(`${url}?${params}`, {\n            method: \"GET\",\n            headers: {\n                \"Accept\": \"application/json\",\n                \"User-Agent\": \"OpsIntel-Dashboard/1.0\"\n            },\n            // 10 second timeout\n            signal: AbortSignal.timeout(10000)\n        });\n        if (!response.ok) {\n            if (response.status === 401) {\n                throw new Error(\"Invalid OpenWeatherMap API key\");\n            }\n            if (response.status === 429) {\n                throw new Error(\"OpenWeatherMap API rate limit exceeded. Please try again later.\");\n            }\n            if (response.status === 404) {\n                throw new Error(\"Location not found in OpenWeatherMap API\");\n            }\n            throw new Error(`OpenWeatherMap API error: ${response.status} ${response.statusText}`);\n        }\n        const data = await response.json();\n        if (!data.main?.temp) {\n            throw new Error(\"Invalid weather data received from API\");\n        }\n        const temperature = Math.round(data.main.temp);\n        if (isNaN(temperature)) {\n            throw new Error(\"Invalid temperature value received\");\n        }\n        // Check for weather alerts\n        let alertMessage = \"none\";\n        // Check if there are any severe weather conditions\n        if (data.weather && data.weather.length > 0) {\n            const mainWeather = data.weather[0];\n            // Check for severe weather conditions based on weather IDs\n            // OpenWeatherMap weather condition IDs: https://openweathermap.org/weather-conditions\n            const severeWeatherIds = [\n                200,\n                201,\n                202,\n                210,\n                211,\n                212,\n                221,\n                230,\n                231,\n                232,\n                502,\n                503,\n                504,\n                511,\n                522,\n                531,\n                602,\n                622,\n                711,\n                721,\n                731,\n                741,\n                751,\n                761,\n                762,\n                771,\n                781 // Atmospheric conditions\n            ];\n            if (severeWeatherIds.includes(mainWeather.id)) {\n                alertMessage = `${mainWeather.main}: ${mainWeather.description}`;\n            }\n            // Check for extreme temperatures\n            if (temperature >= 100) {\n                alertMessage = \"Extreme heat warning\";\n            } else if (temperature <= 32) {\n                alertMessage = \"Freezing temperature alert\";\n            }\n        }\n        // Additional check for alerts from the API response (if available)\n        if (data.alerts && data.alerts.length > 0) {\n            // Use the first active alert\n            const activeAlert = data.alerts[0];\n            alertMessage = activeAlert.event || activeAlert.description || \"Weather alert active\";\n        }\n        const result = {\n            temp: temperature,\n            alert: alertMessage\n        };\n        // Cache the result\n        cache.set(CACHE_KEY, result, CACHE_TTL);\n        return result;\n    } catch (error) {\n        console.error(\"Error fetching weather data:\", error);\n        // Return fallback data in case of error\n        return {\n            temp: 75,\n            alert: \"Weather data unavailable\"\n        };\n    }\n}\n/**\n * Utility function to clear the weather cache\n * Useful for testing or forcing fresh data retrieval\n */ function clearWeatherCache() {\n    cache.get(CACHE_KEY) && cache.set(CACHE_KEY, null, 0);\n}\n/**\n * Utility function to get cache status\n * Returns whether cached data exists and when it expires\n */ function getWeatherCacheStatus() {\n    const item = cache.get(CACHE_KEY);\n    return {\n        cached: !!item,\n        expiresAt: item ? new Date(Date.now() + CACHE_TTL) : undefined\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFDZDVELE1BQU1JLEdBQUcsQ0FBQ0ssY0FBY1QsTUFBTUosR0FBRyxDQUFDYSxXQUFXLE1BQU07QUFDckQ7QUFFQTs7O0NBR0MsR0FDTSxTQUFTb0Q7SUFDZCxNQUFNeEQsT0FBT0wsTUFBTUksR0FBRyxDQUFDSztJQUN2QixPQUFPO1FBQ0xxRCxRQUFRLENBQUMsQ0FBQ3pEO1FBQ1YwRCxXQUFXMUQsT0FBTyxJQUFJSCxLQUFLQSxLQUFLQyxHQUFHLEtBQUtLLGFBQWF3RDtJQUN2RDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3BzaW50ZWwtYWktZGFzaGJvYXJkLy4vc3JjL2xpYi9mZXRjaFdlYXRoZXIudHM/NmMzZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbnRlcmZhY2UgV2VhdGhlclJlc3BvbnNlIHtcbiAgbWFpbjoge1xuICAgIHRlbXA6IG51bWJlcjtcbiAgICBmZWVsc19saWtlOiBudW1iZXI7XG4gICAgdGVtcF9taW46IG51bWJlcjtcbiAgICB0ZW1wX21heDogbnVtYmVyO1xuICAgIHByZXNzdXJlOiBudW1iZXI7XG4gICAgaHVtaWRpdHk6IG51bWJlcjtcbiAgfTtcbiAgd2VhdGhlcjogQXJyYXk8e1xuICAgIGlkOiBudW1iZXI7XG4gICAgbWFpbjogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgaWNvbjogc3RyaW5nO1xuICB9PjtcbiAgYWxlcnRzPzogQXJyYXk8e1xuICAgIHNlbmRlcl9uYW1lOiBzdHJpbmc7XG4gICAgZXZlbnQ6IHN0cmluZztcbiAgICBzdGFydDogbnVtYmVyO1xuICAgIGVuZDogbnVtYmVyO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgdGFnczogc3RyaW5nW107XG4gIH0+O1xuICBuYW1lOiBzdHJpbmc7XG4gIGNvZDogbnVtYmVyO1xufVxuXG5pbnRlcmZhY2UgV2VhdGhlckRhdGEge1xuICB0ZW1wOiBudW1iZXI7XG4gIGFsZXJ0OiBzdHJpbmc7XG59XG5cbi8vIFNpbXBsZSBpbi1tZW1vcnkgY2FjaGUgd2l0aCBUVExcbmNsYXNzIFNpbXBsZUNhY2hlIHtcbiAgcHJpdmF0ZSBjYWNoZSA9IG5ldyBNYXA8c3RyaW5nLCB7IGRhdGE6IGFueTsgZXhwaXJlczogbnVtYmVyIH0+KCk7XG5cbiAgc2V0KGtleTogc3RyaW5nLCBkYXRhOiBhbnksIHR0bE1zOiBudW1iZXIpIHtcbiAgICB0aGlzLmNhY2hlLnNldChrZXksIHtcbiAgICAgIGRhdGEsXG4gICAgICBleHBpcmVzOiBEYXRlLm5vdygpICsgdHRsTXNcbiAgICB9KTtcbiAgfVxuXG4gIGdldChrZXk6IHN0cmluZykge1xuICAgIGNvbnN0IGl0ZW0gPSB0aGlzLmNhY2hlLmdldChrZXkpO1xuICAgIGlmICghaXRlbSkgcmV0dXJuIG51bGw7XG4gICAgXG4gICAgaWYgKERhdGUubm93KCkgPiBpdGVtLmV4cGlyZXMpIHtcbiAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGl0ZW0uZGF0YTtcbiAgfVxufVxuXG5jb25zdCBjYWNoZSA9IG5ldyBTaW1wbGVDYWNoZSgpO1xuY29uc3QgQ0FDSEVfVFRMID0gMTUgKiA2MCAqIDEwMDA7IC8vIDE1IG1pbnV0ZXMgaW4gbWlsbGlzZWNvbmRzXG5jb25zdCBDQUNIRV9LRVkgPSAnZWxfcGFzb193ZWF0aGVyJztcblxuLy8gRWwgUGFzbywgVFggY29vcmRpbmF0ZXNcbmNvbnN0IEVMX1BBU09fTEFUID0gMzEuNzYxOTtcbmNvbnN0IEVMX1BBU09fTE9OID0gLTEwNi40ODUwO1xuXG4vKipcbiAqIEZldGNoZXMgY3VycmVudCB3ZWF0aGVyIGRhdGEgZm9yIEVsIFBhc28sIFRYIGZyb20gT3BlbldlYXRoZXJNYXAgQVBJXG4gKiBcbiAqIEByZXR1cm5zIFByb21pc2U8V2VhdGhlckRhdGE+IE9iamVjdCBjb250YWluaW5nIHRlbXBlcmF0dXJlIGluIEZhaHJlbmhlaXQgYW5kIGFueSBhY3RpdmUgd2VhdGhlciBhbGVydHNcbiAqIEB0aHJvd3MgRXJyb3Igd2hlbiBBUEkga2V5IGlzIG1pc3Npbmcgb3IgQVBJIHJlcXVlc3QgZmFpbHNcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGNvbnN0IHdlYXRoZXIgPSBhd2FpdCBnZXRMb2NhbFdlYXRoZXIoKTtcbiAqIGNvbnNvbGUubG9nKGBDdXJyZW50IHRlbXA6ICR7d2VhdGhlci50ZW1wfcKwRiwgQWxlcnQ6ICR7d2VhdGhlci5hbGVydH1gKTtcbiAqIGBgYFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TG9jYWxXZWF0aGVyKCk6IFByb21pc2U8V2VhdGhlckRhdGE+IHtcbiAgLy8gQ2hlY2sgY2FjaGUgZmlyc3RcbiAgY29uc3QgY2FjaGVkRGF0YSA9IGNhY2hlLmdldChDQUNIRV9LRVkpO1xuICBpZiAoY2FjaGVkRGF0YSkge1xuICAgIHJldHVybiBjYWNoZWREYXRhO1xuICB9XG5cbiAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuV0VBVEhFUl9BUElfS0VZO1xuICBpZiAoIWFwaUtleSkge1xuICAgIHRocm93IG5ldyBFcnJvcignV0VBVEhFUl9BUElfS0VZIGVudmlyb25tZW50IHZhcmlhYmxlIGlzIHJlcXVpcmVkJyk7XG4gIH1cblxuICB0cnkge1xuICAgIC8vIE9wZW5XZWF0aGVyTWFwIEN1cnJlbnQgV2VhdGhlciBBUEkgZW5kcG9pbnRcbiAgICBjb25zdCB1cmwgPSAnaHR0cHM6Ly9hcGkub3BlbndlYXRoZXJtYXAub3JnL2RhdGEvMi41L3dlYXRoZXInO1xuICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgbGF0OiBFTF9QQVNPX0xBVC50b1N0cmluZygpLFxuICAgICAgbG9uOiBFTF9QQVNPX0xPTi50b1N0cmluZygpLFxuICAgICAgYXBwaWQ6IGFwaUtleSxcbiAgICAgIHVuaXRzOiAnaW1wZXJpYWwnLCAvLyBGYWhyZW5oZWl0XG4gICAgICBsYW5nOiAnZW4nXG4gICAgfSk7XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3VybH0/JHtwYXJhbXN9YCwge1xuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgJ1VzZXItQWdlbnQnOiAnT3BzSW50ZWwtRGFzaGJvYXJkLzEuMCdcbiAgICAgIH0sXG4gICAgICAvLyAxMCBzZWNvbmQgdGltZW91dFxuICAgICAgc2lnbmFsOiBBYm9ydFNpZ25hbC50aW1lb3V0KDEwMDAwKVxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBPcGVuV2VhdGhlck1hcCBBUEkga2V5Jyk7XG4gICAgICB9XG4gICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MjkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdPcGVuV2VhdGhlck1hcCBBUEkgcmF0ZSBsaW1pdCBleGNlZWRlZC4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci4nKTtcbiAgICAgIH1cbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwNCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xvY2F0aW9uIG5vdCBmb3VuZCBpbiBPcGVuV2VhdGhlck1hcCBBUEknKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBFcnJvcihgT3BlbldlYXRoZXJNYXAgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgIH1cblxuICAgIGNvbnN0IGRhdGE6IFdlYXRoZXJSZXNwb25zZSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICBcbiAgICBpZiAoIWRhdGEubWFpbj8udGVtcCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHdlYXRoZXIgZGF0YSByZWNlaXZlZCBmcm9tIEFQSScpO1xuICAgIH1cblxuICAgIGNvbnN0IHRlbXBlcmF0dXJlID0gTWF0aC5yb3VuZChkYXRhLm1haW4udGVtcCk7XG4gICAgXG4gICAgaWYgKGlzTmFOKHRlbXBlcmF0dXJlKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHRlbXBlcmF0dXJlIHZhbHVlIHJlY2VpdmVkJyk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIHdlYXRoZXIgYWxlcnRzXG4gICAgbGV0IGFsZXJ0TWVzc2FnZSA9IFwibm9uZVwiO1xuICAgIFxuICAgIC8vIENoZWNrIGlmIHRoZXJlIGFyZSBhbnkgc2V2ZXJlIHdlYXRoZXIgY29uZGl0aW9uc1xuICAgIGlmIChkYXRhLndlYXRoZXIgJiYgZGF0YS53ZWF0aGVyLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IG1haW5XZWF0aGVyID0gZGF0YS53ZWF0aGVyWzBdO1xuICAgICAgXG4gICAgICAvLyBDaGVjayBmb3Igc2V2ZXJlIHdlYXRoZXIgY29uZGl0aW9ucyBiYXNlZCBvbiB3ZWF0aGVyIElEc1xuICAgICAgLy8gT3BlbldlYXRoZXJNYXAgd2VhdGhlciBjb25kaXRpb24gSURzOiBodHRwczovL29wZW53ZWF0aGVybWFwLm9yZy93ZWF0aGVyLWNvbmRpdGlvbnNcbiAgICAgIGNvbnN0IHNldmVyZVdlYXRoZXJJZHMgPSBbXG4gICAgICAgIDIwMCwgMjAxLCAyMDIsIDIxMCwgMjExLCAyMTIsIDIyMSwgMjMwLCAyMzEsIDIzMiwgLy8gVGh1bmRlcnN0b3Jtc1xuICAgICAgICA1MDIsIDUwMywgNTA0LCA1MTEsIDUyMiwgNTMxLCAvLyBIZWF2eSByYWluXG4gICAgICAgIDYwMiwgNjIyLCAvLyBIZWF2eSBzbm93XG4gICAgICAgIDcxMSwgNzIxLCA3MzEsIDc0MSwgNzUxLCA3NjEsIDc2MiwgNzcxLCA3ODEgLy8gQXRtb3NwaGVyaWMgY29uZGl0aW9uc1xuICAgICAgXTtcbiAgICAgIFxuICAgICAgaWYgKHNldmVyZVdlYXRoZXJJZHMuaW5jbHVkZXMobWFpbldlYXRoZXIuaWQpKSB7XG4gICAgICAgIGFsZXJ0TWVzc2FnZSA9IGAke21haW5XZWF0aGVyLm1haW59OiAke21haW5XZWF0aGVyLmRlc2NyaXB0aW9ufWA7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIENoZWNrIGZvciBleHRyZW1lIHRlbXBlcmF0dXJlc1xuICAgICAgaWYgKHRlbXBlcmF0dXJlID49IDEwMCkge1xuICAgICAgICBhbGVydE1lc3NhZ2UgPSBcIkV4dHJlbWUgaGVhdCB3YXJuaW5nXCI7XG4gICAgICB9IGVsc2UgaWYgKHRlbXBlcmF0dXJlIDw9IDMyKSB7XG4gICAgICAgIGFsZXJ0TWVzc2FnZSA9IFwiRnJlZXppbmcgdGVtcGVyYXR1cmUgYWxlcnRcIjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBZGRpdGlvbmFsIGNoZWNrIGZvciBhbGVydHMgZnJvbSB0aGUgQVBJIHJlc3BvbnNlIChpZiBhdmFpbGFibGUpXG4gICAgaWYgKGRhdGEuYWxlcnRzICYmIGRhdGEuYWxlcnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIFVzZSB0aGUgZmlyc3QgYWN0aXZlIGFsZXJ0XG4gICAgICBjb25zdCBhY3RpdmVBbGVydCA9IGRhdGEuYWxlcnRzWzBdO1xuICAgICAgYWxlcnRNZXNzYWdlID0gYWN0aXZlQWxlcnQuZXZlbnQgfHwgYWN0aXZlQWxlcnQuZGVzY3JpcHRpb24gfHwgXCJXZWF0aGVyIGFsZXJ0IGFjdGl2ZVwiO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdDogV2VhdGhlckRhdGEgPSB7XG4gICAgICB0ZW1wOiB0ZW1wZXJhdHVyZSxcbiAgICAgIGFsZXJ0OiBhbGVydE1lc3NhZ2VcbiAgICB9O1xuXG4gICAgLy8gQ2FjaGUgdGhlIHJlc3VsdFxuICAgIGNhY2hlLnNldChDQUNIRV9LRVksIHJlc3VsdCwgQ0FDSEVfVFRMKTtcbiAgICBcbiAgICByZXR1cm4gcmVzdWx0O1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgd2VhdGhlciBkYXRhOicsIGVycm9yKTtcbiAgICBcbiAgICAvLyBSZXR1cm4gZmFsbGJhY2sgZGF0YSBpbiBjYXNlIG9mIGVycm9yXG4gICAgcmV0dXJuIHtcbiAgICAgIHRlbXA6IDc1LFxuICAgICAgYWxlcnQ6IFwiV2VhdGhlciBkYXRhIHVuYXZhaWxhYmxlXCJcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogVXRpbGl0eSBmdW5jdGlvbiB0byBjbGVhciB0aGUgd2VhdGhlciBjYWNoZVxuICogVXNlZnVsIGZvciB0ZXN0aW5nIG9yIGZvcmNpbmcgZnJlc2ggZGF0YSByZXRyaWV2YWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyV2VhdGhlckNhY2hlKCk6IHZvaWQge1xuICBjYWNoZS5nZXQoQ0FDSEVfS0VZKSAmJiBjYWNoZS5zZXQoQ0FDSEVfS0VZLCBudWxsLCAwKTtcbn1cblxuLyoqXG4gKiBVdGlsaXR5IGZ1bmN0aW9uIHRvIGdldCBjYWNoZSBzdGF0dXNcbiAqIFJldHVybnMgd2hldGhlciBjYWNoZWQgZGF0YSBleGlzdHMgYW5kIHdoZW4gaXQgZXhwaXJlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0V2VhdGhlckNhY2hlU3RhdHVzKCk6IHsgY2FjaGVkOiBib29sZWFuOyBleHBpcmVzQXQ/OiBEYXRlIH0ge1xuICBjb25zdCBpdGVtID0gY2FjaGUuZ2V0KENBQ0hFX0tFWSk7XG4gIHJldHVybiB7XG4gICAgY2FjaGVkOiAhIWl0ZW0sXG4gICAgZXhwaXJlc0F0OiBpdGVtID8gbmV3IERhdGUoRGF0ZS5ub3coKSArIENBQ0hFX1RUTCkgOiB1bmRlZmluZWRcbiAgfTtcbn0iXSwibmFtZXMiOlsiU2ltcGxlQ2FjaGUiLCJzZXQiLCJrZXkiLCJkYXRhIiwidHRsTXMiLCJjYWNoZSIsImV4cGlyZXMiLCJEYXRlIiwibm93IiwiZ2V0IiwiaXRlbSIsImRlbGV0ZSIsIk1hcCIsIkNBQ0hFX1RUTCIsIkNBQ0hFX0tFWSIsIkVMX1BBU09fTEFUIiwiRUxfUEFTT19MT04iLCJnZXRMb2NhbFdlYXRoZXIiLCJjYWNoZWREYXRhIiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIldFQVRIRVJfQVBJX0tFWSIsIkVycm9yIiwidXJsIiwicGFyYW1zIiwiVVJMU2VhcmNoUGFyYW1zIiwibGF0IiwidG9TdHJpbmciLCJsb24iLCJhcHBpZCIsInVuaXRzIiwibGFuZyIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwic2lnbmFsIiwiQWJvcnRTaWduYWwiLCJ0aW1lb3V0Iiwib2siLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwianNvbiIsIm1haW4iLCJ0ZW1wIiwidGVtcGVyYXR1cmUiLCJNYXRoIiwicm91bmQiLCJpc05hTiIsImFsZXJ0TWVzc2FnZSIsIndlYXRoZXIiLCJsZW5ndGgiLCJtYWluV2VhdGhlciIsInNldmVyZVdlYXRoZXJJZHMiLCJpbmNsdWRlcyIsImlkIiwiZGVzY3JpcHRpb24iLCJhbGVydHMiLCJhY3RpdmVBbGVydCIsImV2ZW50IiwicmVzdWx0IiwiYWxlcnQiLCJlcnJvciIsImNvbnNvbGUiLCJjbGVhcldlYXRoZXJDYWNoZSIsImdldFdlYXRoZXJDYWNoZVN0YXR1cyIsImNhY2hlZCIsImV4cGlyZXNBdCIsInVuZGVmaW5lZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/fetchWeather.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendors"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdashboard&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fdashboard.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();